"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{36420:function(e,t,a){var r,n,i,s,o,c,l,d,u,h,p,g,y,f,m,T,_,E,b,v,A,C,x,S,I,k,H,w,D,V,B,P,N,O,F,R=Object.create,M=Object.defineProperty,L=Object.getOwnPropertyDescriptor,U=Object.getOwnPropertyNames,$=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty,__export=(e,t)=>{for(var a in t)M(e,a,{get:t[a],enumerable:!0})},__copyProps=(e,t,a,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of U(t))j.call(e,n)||n===a||M(e,n,{get:()=>t[n],enumerable:!(r=L(t,n))||r.enumerable});return e},__toESM=(e,t,a)=>(a=null!=e?R($(e)):{},__copyProps(!t&&e&&e.__esModule?a:M(a,"default",{value:e,enumerable:!0}),e)),q={};__export(q,{Account:()=>ay,AccountInterface:()=>af,BlockStatus:()=>eW,BlockTag:()=>eY,CairoCustomEnum:()=>ti,CairoOption:()=>to,CairoOptionVariant:()=>ts,CairoResult:()=>tl,CairoResultVariant:()=>tc,CairoUint256:()=>te,CairoUint512:()=>tn,CallData:()=>tp,Contract:()=>a_,ContractFactory:()=>ab,ContractInterface:()=>aE,CustomError:()=>eB,EntryPointType:()=>eU,EthSigner:()=>ap,GatewayError:()=>eN,HttpError:()=>eO,LibraryError:()=>eP,Literal:()=>eL,Provider:()=>at,ProviderInterface:()=>aa,RPC:()=>W,RPC06:()=>eV,RPC07:()=>tq,RPCResponseParser:()=>tY,ReceiptTx:()=>tG,ResponseParser:()=>av,RpcChannel:()=>tW,RpcProvider:()=>at,Signer:()=>ad,SignerInterface:()=>an,TransactionExecutionStatus:()=>eK,TransactionFinalityStatus:()=>eq,TransactionStatus:()=>ej,TransactionType:()=>e$,TypedDataRevision:()=>eG.TypedDataRevision,UINT_128_MAX:()=>e5,UINT_128_MIN:()=>tr,UINT_256_HIGH_MAX:()=>e8,UINT_256_HIGH_MIN:()=>e7,UINT_256_LOW_MAX:()=>e4,UINT_256_LOW_MIN:()=>e9,UINT_256_MAX:()=>e6,UINT_256_MIN:()=>e3,UINT_512_MAX:()=>tt,UINT_512_MIN:()=>ta,Uint:()=>eM,ValidateType:()=>eR,WalletAccount:()=>aT,addAddressPadding:()=>addAddressPadding,buildUrl:()=>buildUrl,byteArray:()=>e1,cairo:()=>e2,constants:()=>K,contractClassResponseToLegacyCompiledContract:()=>contractClassResponseToLegacyCompiledContract,defaultProvider:()=>ar,ec:()=>tm,encode:()=>el,eth:()=>tB,events:()=>ag,extractContractHashes:()=>extractContractHashes,fixProto:()=>fixProto,fixStack:()=>fixStack,getCalldata:()=>getCalldata,getChecksumAddress:()=>getChecksumAddress,hash:()=>tg,isSierra:()=>isSierra,isUrl:()=>isUrl,json:()=>tS,merkle:()=>as,num:()=>eX,number:()=>ak,parseCalldataField:()=>parseCalldataField,provider:()=>tR,selector:()=>eJ,shortString:()=>e0,splitArgsAndOptions:()=>splitArgsAndOptions,stark:()=>tw,starknetId:()=>tZ,transaction:()=>tU,typedData:()=>ai,types:()=>eF,uint256:()=>ah,v2hash:()=>tf,v3hash:()=>tE,validateAndParseAddress:()=>validateAndParseAddress,validateChecksumAddress:()=>validateChecksumAddress,wallet:()=>am}),e.exports=__copyProps(M({},"__esModule",{value:!0}),q);var K={};__export(K,{ADDR_BOUND:()=>eT,API_VERSION:()=>ey,BaseUrl:()=>ev,FeeMarginPercentage:()=>eS,IS_BROWSER:()=>eu,MASK_250:()=>eg,MAX_STORAGE_ITEM_SIZE:()=>em,NetworkName:()=>eA,PRIME:()=>ef,RANGE_FELT:()=>e_,RANGE_I128:()=>eE,RANGE_U128:()=>eb,RPC_DEFAULT_VERSION:()=>ek,RPC_NODES:()=>eH,StarknetChainId:()=>eC,TEXT_TO_FELT_MAX_LEN:()=>eh,TRANSACTION_VERSION:()=>W.ETransactionVersion,TransactionHashPrefix:()=>ex,UDC:()=>eI,ZERO:()=>ep});var W={};__export(W,{JRPC:()=>Y,RPCSPEC06:()=>G,RPCSPEC07:()=>ec});var Y={},G={};__export(G,{EBlockTag:()=>ea,EDAMode:()=>en,EDataAvailabilityMode:()=>er,ESimulationFlag:()=>J,ETransactionExecutionStatus:()=>et,ETransactionFinalityStatus:()=>ee,ETransactionStatus:()=>Q,ETransactionType:()=>Z,ETransactionVersion:()=>ei,ETransactionVersion2:()=>es,ETransactionVersion3:()=>eo,Errors:()=>X,SPEC:()=>z});var X={},z={},Z=((r=Z||{}).DECLARE="DECLARE",r.DEPLOY="DEPLOY",r.DEPLOY_ACCOUNT="DEPLOY_ACCOUNT",r.INVOKE="INVOKE",r.L1_HANDLER="L1_HANDLER",r),J=((n=J||{}).SKIP_VALIDATE="SKIP_VALIDATE",n.SKIP_FEE_CHARGE="SKIP_FEE_CHARGE",n),Q=((i=Q||{}).RECEIVED="RECEIVED",i.REJECTED="REJECTED",i.ACCEPTED_ON_L2="ACCEPTED_ON_L2",i.ACCEPTED_ON_L1="ACCEPTED_ON_L1",i),ee=((s=ee||{}).ACCEPTED_ON_L2="ACCEPTED_ON_L2",s.ACCEPTED_ON_L1="ACCEPTED_ON_L1",s),et=((o=et||{}).SUCCEEDED="SUCCEEDED",o.REVERTED="REVERTED",o),ea=((c=ea||{}).PENDING="pending",c.LATEST="latest",c),er=((l=er||{}).L1="L1",l.L2="L2",l),en=((d=en||{})[d.L1=0]="L1",d[d.L2=1]="L2",d),ei=((u=ei||{}).V0="0x0",u.V1="0x1",u.V2="0x2",u.V3="0x3",u.F0="0x100000000000000000000000000000000",u.F1="0x100000000000000000000000000000001",u.F2="0x100000000000000000000000000000002",u.F3="0x100000000000000000000000000000003",u),es=((h=es||{}).V0="0x0",h.V1="0x1",h.V2="0x2",h.F0="0x100000000000000000000000000000000",h.F1="0x100000000000000000000000000000001",h.F2="0x100000000000000000000000000000002",h),eo=((p=eo||{}).V3="0x3",p.F3="0x100000000000000000000000000000003",p),ec=__toESM(a(44438));__copyProps(W,g=a(44438),"default"),y&&__copyProps(y,g,"default");var el={};__export(el,{IS_BROWSER:()=>eu,addHexPrefix:()=>addHexPrefix,arrayBufferToString:()=>arrayBufferToString,atobUniversal:()=>atobUniversal,btoaUniversal:()=>btoaUniversal,buf2hex:()=>buf2hex,calcByteLength:()=>calcByteLength,padLeft:()=>padLeft,pascalToSnake:()=>pascalToSnake,removeHexPrefix:()=>removeHexPrefix,sanitizeBytes:()=>sanitizeBytes,sanitizeHex:()=>sanitizeHex,stringToArrayBuffer:()=>stringToArrayBuffer,utf8ToArray:()=>utf8ToArray});var ed=a(71081),eu="undefined"!=typeof window;function arrayBufferToString(e){return new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),"")}function utf8ToArray(e){return new TextEncoder().encode(e)}function stringToArrayBuffer(e){return utf8ToArray(e)}function atobUniversal(e){return ed.base64.decode(e)}function btoaUniversal(e){return ed.base64.encode(new Uint8Array(e))}function buf2hex(e){return e.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}function removeHexPrefix(e){return e.replace(/^0x/i,"")}function addHexPrefix(e){return`0x${removeHexPrefix(e)}`}function padLeft(e,t,a="0"){return function(e,t,a,r="0"){let n=t-e.length,i=e;if(n>0){let t=r.repeat(n);i=a?t+e:e+t}return i}(e,t,!0,a)}function calcByteLength(e,t=8){let{length:a}=e,r=a%t;return r?(a-r)/t*t+t:a}function sanitizeBytes(e,t=8,a="0"){return padLeft(e,calcByteLength(e,t),a)}function sanitizeHex(e){return(e=sanitizeBytes(e=removeHexPrefix(e),2))&&(e=addHexPrefix(e)),e}var pascalToSnake=e=>/[a-z]/.test(e)?e.split(/(?=[A-Z])/).join("_").toUpperCase():e,eh=31,ep=0n,eg=2n**250n-1n,ey=ep,ef=2n**251n+17n*2n**192n+1n,em=256n,eT=2n**251n-em,range=(e,t)=>({min:e,max:t}),e_=range(ep,ef-1n),eE=range(-(2n**127n),2n**127n-1n),eb=range(ep,2n**128n-1n),ev=((f=ev||{}).SN_MAIN="https://alpha-mainnet.starknet.io",f.SN_SEPOLIA="https://alpha-sepolia.starknet.io",f),eA=((m=eA||{}).SN_MAIN="SN_MAIN",m.SN_SEPOLIA="SN_SEPOLIA",m),eC=((T=eC||{}).SN_MAIN="0x534e5f4d41494e",T.SN_SEPOLIA="0x534e5f5345504f4c4941",T),ex=((_=ex||{}).DECLARE="0x6465636c617265",_.DEPLOY="0x6465706c6f79",_.DEPLOY_ACCOUNT="0x6465706c6f795f6163636f756e74",_.INVOKE="0x696e766f6b65",_.L1_HANDLER="0x6c315f68616e646c6572",_),eS=((E=eS||{})[E.L1_BOUND_MAX_AMOUNT=50]="L1_BOUND_MAX_AMOUNT",E[E.L1_BOUND_MAX_PRICE_PER_UNIT=50]="L1_BOUND_MAX_PRICE_PER_UNIT",E[E.MAX_FEE=50]="MAX_FEE",E),eI={ADDRESS:"0x041a78e741e5af2fec34b695679bc6891742439f7afb8484ecd7766661ad02bf",ENTRYPOINT:"deployContract"},ek="v0_7",eH={SN_MAIN:[`https://starknet-mainnet.public.blastapi.io/rpc/${ek}`,`https://free-rpc.nethermind.io/mainnet-juno/${ek}`],SN_SEPOLIA:[`https://starknet-sepolia.public.blastapi.io/rpc/${ek}`,`https://free-rpc.nethermind.io/sepolia-juno/${ek}`]},ew=a(9653),eD=a(83413),eV={};function fixStack(e,t=e.constructor){let{captureStackTrace:a}=Error;a&&a(e,t)}function fixProto(e,t){let{setPrototypeOf:a}=Object;a?a(e,t):e.__proto__=t}__export(eV,{RpcChannel:()=>tj});var eB=class extends Error{name;constructor(e){super(e),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),fixProto(this,new.target.prototype),fixStack(this)}},eP=class extends eB{},eN=class extends eP{constructor(e,t){super(e),this.errorCode=t}},eO=class extends eP{constructor(e,t){super(e),this.errorCode=t}},eF={};__export(eF,{BlockStatus:()=>eW,BlockTag:()=>eY,EntryPointType:()=>eU,Literal:()=>eL,RPC:()=>W,TransactionExecutionStatus:()=>eK,TransactionFinalityStatus:()=>eq,TransactionStatus:()=>ej,TransactionType:()=>e$,TypedDataRevision:()=>eG.TypedDataRevision,Uint:()=>eM,ValidateType:()=>eR});var eR=((b=eR||{}).DEPLOY="DEPLOY",b.CALL="CALL",b.INVOKE="INVOKE",b),eM=((v=eM||{}).u8="core::integer::u8",v.u16="core::integer::u16",v.u32="core::integer::u32",v.u64="core::integer::u64",v.u128="core::integer::u128",v.u256="core::integer::u256",v.u512="core::integer::u512",v),eL=((A=eL||{}).ClassHash="core::starknet::class_hash::ClassHash",A.ContractAddress="core::starknet::contract_address::ContractAddress",A.Secp256k1Point="core::starknet::secp256k1::Secp256k1Point",A),eU=((C=eU||{}).EXTERNAL="EXTERNAL",C.L1_HANDLER="L1_HANDLER",C.CONSTRUCTOR="CONSTRUCTOR",C),e$=((x=e$||{}).DECLARE="DECLARE",x.DEPLOY="DEPLOY",x.DEPLOY_ACCOUNT="DEPLOY_ACCOUNT",x.INVOKE="INVOKE_FUNCTION",x),ej=((S=ej||{}).NOT_RECEIVED="NOT_RECEIVED",S.RECEIVED="RECEIVED",S.ACCEPTED_ON_L2="ACCEPTED_ON_L2",S.ACCEPTED_ON_L1="ACCEPTED_ON_L1",S.REJECTED="REJECTED",S.REVERTED="REVERTED",S),eq=((I=eq||{}).NOT_RECEIVED="NOT_RECEIVED",I.RECEIVED="RECEIVED",I.ACCEPTED_ON_L2="ACCEPTED_ON_L2",I.ACCEPTED_ON_L1="ACCEPTED_ON_L1",I),eK=((k=eK||{}).REJECTED="REJECTED",k.REVERTED="REVERTED",k.SUCCEEDED="SUCCEEDED",k),eW=((H=eW||{}).PENDING="PENDING",H.ACCEPTED_ON_L1="ACCEPTED_ON_L1",H.ACCEPTED_ON_L2="ACCEPTED_ON_L2",H.REJECTED="REJECTED",H),eY=((w=eY||{}).PENDING="pending",w.LATEST="latest",w),eG=a(44438);function assert(e,t){if(!e)throw Error(t||"Assertion failure")}var eX={};__export(eX,{addPercent:()=>addPercent,assertInRange:()=>assertInRange,bigNumberishArrayToDecimalStringArray:()=>bigNumberishArrayToDecimalStringArray,bigNumberishArrayToHexadecimalStringArray:()=>bigNumberishArrayToHexadecimalStringArray,cleanHex:()=>cleanHex,getDecimalString:()=>getDecimalString,getHexString:()=>getHexString,getHexStringArray:()=>getHexStringArray,hexToBytes:()=>hexToBytes,hexToDecimalString:()=>hexToDecimalString,isBigInt:()=>isBigInt,isBoolean:()=>isBoolean,isHex:()=>isHex,isNumber:()=>isNumber,isStringWholeNumber:()=>isStringWholeNumber,toBigInt:()=>toBigInt,toCairoBool:()=>toCairoBool,toHex:()=>toHex,toHexString:()=>eZ,toStorageKey:()=>toStorageKey});var ez=a(9653);function isHex(e){return/^0x[0-9a-f]*$/i.test(e)}function toBigInt(e){return BigInt(e)}function isBigInt(e){return"bigint"==typeof e}function toHex(e){return addHexPrefix(toBigInt(e).toString(16))}var eZ=toHex;function toStorageKey(e){return addHexPrefix(toBigInt(e).toString(16).padStart(64,"0"))}function hexToDecimalString(e){return BigInt(addHexPrefix(e)).toString(10)}function cleanHex(e){return e.toLowerCase().replace(/^(0x)0+/,"$1")}function assertInRange(e,t,a,r=""){let n=""===r?"invalid length":`invalid ${r} length`,i=BigInt(e),s=BigInt(t),o=BigInt(a);assert(i>=s&&i<=o,`Message not signable, ${n}.`)}function bigNumberishArrayToDecimalStringArray(e){return e.map(e=>toBigInt(e).toString(10))}function bigNumberishArrayToHexadecimalStringArray(e){return e.map(e=>toHex(e))}function isStringWholeNumber(e){return/^\d+$/.test(e)}function getDecimalString(e){if(isHex(e))return hexToDecimalString(e);if(isStringWholeNumber(e))return e;throw Error(`${e} needs to be a hex-string or whole-number-string`)}function getHexString(e){if(isHex(e))return e;if(isStringWholeNumber(e))return eZ(e);throw Error(`${e} needs to be a hex-string or whole-number-string`)}function getHexStringArray(e){return e.map(getHexString)}function toCairoBool(e){return(+e).toString()}function hexToBytes(e){if(!isHex(e))throw Error(`${e} needs to be a hex-string`);let t=removeHexPrefix(e);return t.length%2!=0&&(t=`0${t}`),(0,ez.hexToBytes)(t)}function addPercent(e,t){let a=BigInt(e);return a+a*BigInt(t)/100n}function isNumber(e){return"number"==typeof e}function isBoolean(e){return"boolean"==typeof e}var eJ={};__export(eJ,{getSelector:()=>getSelector,getSelectorFromName:()=>getSelectorFromName,keccakBn:()=>keccakBn,starknetKeccak:()=>starknetKeccak});var eQ=a(38906);function keccakBn(e){let t=removeHexPrefix(toHex(BigInt(e))),a=t.length%2==0?t:`0${t}`;return addHexPrefix((0,eQ.keccak)(hexToBytes(addHexPrefix(a))).toString(16))}function starknetKeccak(e){let t=BigInt(addHexPrefix((0,eQ.keccak)(utf8ToArray(e)).toString(16)));return t&eg}function getSelectorFromName(e){return toHex(starknetKeccak(e))}function getSelector(e){return isHex(e)?e:isStringWholeNumber(e)?eZ(e):getSelectorFromName(e)}var e0={};function isASCII(e){return/^[\x00-\x7F]*$/.test(e)}function isShortString(e){return e.length<=eh}function isDecimalString(e){return/^[0-9]*$/i.test(e)}function isString(e){return"string"==typeof e}function isText(e){return isString(e)&&!isHex(e)&&!isStringWholeNumber(e)}__export(e0,{decodeShortString:()=>decodeShortString,encodeShortString:()=>encodeShortString,isASCII:()=>isASCII,isDecimalString:()=>isDecimalString,isLongText:()=>isLongText,isShortString:()=>isShortString,isShortText:()=>isShortText,isString:()=>isString,isText:()=>isText,splitLongString:()=>splitLongString});var isShortText=e=>isText(e)&&isShortString(e),isLongText=e=>isText(e)&&!isShortString(e);function splitLongString(e){let t=RegExp(`[^]{1,${eh}}`,"g");return e.match(t)||[]}function encodeShortString(e){if(!isASCII(e))throw Error(`${e} is not an ASCII string`);if(!isShortString(e))throw Error(`${e} is too long`);return addHexPrefix(e.replace(/./g,e=>e.charCodeAt(0).toString(16)))}function decodeShortString(e){if(!isASCII(e))throw Error(`${e} is not an ASCII string`);if(isHex(e))return removeHexPrefix(e).replace(/.{2}/g,e=>String.fromCharCode(parseInt(e,16)));if(isDecimalString(e))return decodeShortString("0X".concat(BigInt(e).toString(16)));throw Error(`${e} is not Hex or decimal`)}var e1={};function stringFromByteArray(e){let t=0n===BigInt(e.pending_word)?"":decodeShortString(toHex(e.pending_word));return e.data.reduce((e,t)=>{let a=0n===BigInt(t)?"":decodeShortString(toHex(t));return e+a},"")+t}function byteArrayFromString(e){let t=splitLongString(e),a=t[t.length-1],r=t.map(encodeShortString),[n,i]=void 0===a||31===a.length?["0x00",0]:[r.pop(),a.length];return{data:0===r.length?[]:r,pending_word:n,pending_word_len:i}}__export(e1,{byteArrayFromString:()=>byteArrayFromString,stringFromByteArray:()=>stringFromByteArray});var e2={};function CairoFelt(e){if(isBigInt(e)||Number.isInteger(e))return e.toString();if(isString(e)){if(isHex(e))return BigInt(e).toString();if(isText(e)){if(!isShortString(e))throw Error(`${e} is a long string > 31 chars. Please split it into an array of short strings.`);return BigInt(encodeShortString(e)).toString()}if(isStringWholeNumber(e))return e}if(isBoolean(e))return`${+e}`;throw Error(`${e} can't be computed by felt()`)}__export(e2,{felt:()=>felt,getAbiContractVersion:()=>getAbiContractVersion,getArrayType:()=>getArrayType,isCairo1Abi:()=>isCairo1Abi,isCairo1Type:()=>isCairo1Type,isLen:()=>isLen,isTypeArray:()=>isTypeArray,isTypeBool:()=>isTypeBool,isTypeByteArray:()=>isTypeByteArray,isTypeBytes31:()=>isTypeBytes31,isTypeContractAddress:()=>isTypeContractAddress,isTypeEnum:()=>isTypeEnum,isTypeEthAddress:()=>isTypeEthAddress,isTypeFelt:()=>isTypeFelt,isTypeLiteral:()=>isTypeLiteral,isTypeNamedTuple:()=>isTypeNamedTuple,isTypeNonZero:()=>isTypeNonZero,isTypeOption:()=>isTypeOption,isTypeResult:()=>isTypeResult,isTypeSecp256k1Point:()=>isTypeSecp256k1Point,isTypeStruct:()=>isTypeStruct,isTypeTuple:()=>isTypeTuple,isTypeUint:()=>isTypeUint,isTypeUint256:()=>isTypeUint256,tuple:()=>tuple,uint256:()=>uint256,uint512:()=>uint512});var e5=(1n<<128n)-1n,e6=(1n<<256n)-1n,e3=0n,e4=0xffffffffffffffffffffffffffffffffn,e8=0xffffffffffffffffffffffffffffffffn,e9=0n,e7=0n,te=class _CairoUint256{low;high;static abiSelector="core::integer::u256";constructor(...e){if("object"==typeof e[0]&&1===e.length&&"low"in e[0]&&"high"in e[0]){let t=_CairoUint256.validateProps(e[0].low,e[0].high);this.low=t.low,this.high=t.high}else if(1===e.length){let t=_CairoUint256.validate(e[0]);this.low=t&e5,this.high=t>>128n}else if(2===e.length){let t=_CairoUint256.validateProps(e[0],e[1]);this.low=t.low,this.high=t.high}else throw Error("Incorrect constructor parameters")}static validate(e){let t=BigInt(e);if(t<e3)throw Error("bigNumberish is smaller than UINT_256_MIN");if(t>e6)throw Error("bigNumberish is bigger than UINT_256_MAX");return t}static validateProps(e,t){let a=BigInt(e),r=BigInt(t);if(a<e9||a>e4)throw Error("low is out of range UINT_256_LOW_MIN - UINT_256_LOW_MAX");if(r<e7||r>e8)throw Error("high is out of range UINT_256_HIGH_MIN - UINT_256_HIGH_MAX");return{low:a,high:r}}static is(e){try{_CairoUint256.validate(e)}catch(e){return!1}return!0}static isAbiType(e){return e===_CairoUint256.abiSelector}toBigInt(){return(this.high<<128n)+this.low}toUint256HexString(){return{low:addHexPrefix(this.low.toString(16)),high:addHexPrefix(this.high.toString(16))}}toUint256DecimalString(){return{low:this.low.toString(10),high:this.high.toString(10)}}toApiRequest(){return[CairoFelt(this.low),CairoFelt(this.high)]}},tt=(1n<<512n)-1n,ta=0n,tr=0n,tn=class _CairoUint512{limb0;limb1;limb2;limb3;static abiSelector="core::integer::u512";constructor(...e){if("object"==typeof e[0]&&1===e.length&&"limb0"in e[0]&&"limb1"in e[0]&&"limb2"in e[0]&&"limb3"in e[0]){let t=_CairoUint512.validateProps(e[0].limb0,e[0].limb1,e[0].limb2,e[0].limb3);this.limb0=t.limb0,this.limb1=t.limb1,this.limb2=t.limb2,this.limb3=t.limb3}else if(1===e.length){let t=_CairoUint512.validate(e[0]);this.limb0=t&e5,this.limb1=(t&e5<<128n)>>128n,this.limb2=(t&e5<<256n)>>256n,this.limb3=t>>384n}else if(4===e.length){let t=_CairoUint512.validateProps(e[0],e[1],e[2],e[3]);this.limb0=t.limb0,this.limb1=t.limb1,this.limb2=t.limb2,this.limb3=t.limb3}else throw Error("Incorrect Uint512 constructor parameters")}static validate(e){let t=BigInt(e);if(t<ta)throw Error("bigNumberish is smaller than UINT_512_MIN.");if(t>tt)throw Error("bigNumberish is bigger than UINT_512_MAX.");return t}static validateProps(e,t,a,r){let n=BigInt(e),i=BigInt(t),s=BigInt(a),o=BigInt(r);return[n,i,s,o].forEach((e,t)=>{if(e<tr||e>e5)throw Error(`limb${t} is not in the range of a u128 number`)}),{limb0:n,limb1:i,limb2:s,limb3:o}}static is(e){try{_CairoUint512.validate(e)}catch(e){return!1}return!0}static isAbiType(e){return e===_CairoUint512.abiSelector}toBigInt(){return(this.limb3<<384n)+(this.limb2<<256n)+(this.limb1<<128n)+this.limb0}toUint512HexString(){return{limb0:addHexPrefix(this.limb0.toString(16)),limb1:addHexPrefix(this.limb1.toString(16)),limb2:addHexPrefix(this.limb2.toString(16)),limb3:addHexPrefix(this.limb3.toString(16))}}toUint512DecimalString(){return{limb0:this.limb0.toString(10),limb1:this.limb1.toString(10),limb2:this.limb2.toString(10),limb3:this.limb3.toString(10)}}toApiRequest(){return[CairoFelt(this.limb0),CairoFelt(this.limb1),CairoFelt(this.limb2),CairoFelt(this.limb3)]}},isLen=e=>/_len$/.test(e),isTypeFelt=e=>"felt"===e||"core::felt252"===e,isTypeArray=e=>/\*/.test(e)||e.startsWith("core::array::Array::")||e.startsWith("core::array::Span::"),isTypeTuple=e=>/^\(.*\)$/i.test(e),isTypeNamedTuple=e=>/\(.*\)/i.test(e)&&e.includes(":"),isTypeStruct=(e,t)=>e in t,isTypeEnum=(e,t)=>e in t,isTypeOption=e=>e.startsWith("core::option::Option::"),isTypeResult=e=>e.startsWith("core::result::Result::"),isTypeUint=e=>Object.values(eM).includes(e),isTypeUint256=e=>te.isAbiType(e),isTypeLiteral=e=>Object.values(eL).includes(e),isTypeBool=e=>"core::bool"===e,isTypeContractAddress=e=>"core::starknet::contract_address::ContractAddress"===e,isTypeEthAddress=e=>"core::starknet::eth_address::EthAddress"===e,isTypeBytes31=e=>"core::bytes_31::bytes31"===e,isTypeByteArray=e=>"core::byte_array::ByteArray"===e,isTypeSecp256k1Point=e=>"core::starknet::secp256k1::Secp256k1Point"===e,isCairo1Type=e=>e.includes("::"),getArrayType=e=>isCairo1Type(e)?e.substring(e.indexOf("<")+1,e.lastIndexOf(">")):e.replace("*","");function isCairo1Abi(e){let{cairo:t}=getAbiContractVersion(e);if(void 0===t)throw Error("Unable to determine Cairo version");return"1"===t}function isTypeNonZero(e){return e.startsWith("core::zeroable::NonZero::")}function getAbiContractVersion(e){if(e.find(e=>"interface"===e.type))return{cairo:"1",compiler:"2"};let t=e.find(e=>"function"===e.type&&(e.inputs.length||e.outputs.length));if(!t)return{cairo:void 0,compiler:void 0};let a=t.inputs.length?t.inputs:t.outputs;return isCairo1Type(a[0].type)?{cairo:"1",compiler:"1"}:{cairo:"0",compiler:"0"}}var uint256=e=>new te(e).toUint256DecimalString(),uint512=e=>new tn(e).toUint512DecimalString(),tuple=(...e)=>({...e});function felt(e){return CairoFelt(e)}var ti=class{variant;constructor(e){let t=Object.values(e);if(0===t.length)throw Error("This Enum must have at least 1 variant");let a=t.filter(e=>void 0!==e).length;if(1!==a)throw Error("This Enum must have exactly one active variant");this.variant=e}unwrap(){let e=Object.entries(this.variant),t=e.find(e=>void 0!==e[1]);if(void 0!==t)return t[1]}activeVariant(){let e=Object.entries(this.variant),t=e.find(e=>void 0!==e[1]);return void 0===t?"":t[0]}},ts=((D=ts||{})[D.Some=0]="Some",D[D.None=1]="None",D),to=class{Some;None;constructor(e,t){if(!(e in ts))throw Error("Wrong variant : should be CairoOptionVariant.Some or .None.");if(0===e){if(void 0===t)throw Error('The creation of a Cairo Option with "Some" variant needs a content as input.');this.Some=t,this.None=void 0}else this.Some=void 0,this.None=!0}unwrap(){if(!this.None)return this.Some}isSome(){return void 0!==this.Some}isNone(){return!0===this.None}},tc=((V=tc||{})[V.Ok=0]="Ok",V[V.Err=1]="Err",V),tl=class{Ok;Err;constructor(e,t){if(!(e in tc))throw Error("Wrong variant : should be CairoResultVariant.Ok or .Err.");0===e?(this.Ok=t,this.Err=void 0):(this.Ok=void 0,this.Err=t)}unwrap(){if(void 0!==this.Ok)return this.Ok;if(void 0!==this.Err)return this.Err;throw Error("Both Result.Ok and .Err are undefined. Not authorized.")}isOk(){return void 0!==this.Ok}isErr(){return void 0!==this.Err}},td={isBN:(e,t,a)=>{if(!isBigInt(e[a]))throw Error(`Data and formatter mismatch on ${a}:${t[a]}, expected response data ${a}:${e[a]} to be BN instead it is ${typeof e[a]}`)},unknown:(e,t,a)=>{throw Error(`Unhandled formatter type on ${a}:${t[a]} for data ${a}:${e[a]}`)}},tu=class{abi;constructor(e){this.abi=e}methodInputsLength(e){return e.inputs.reduce((e,t)=>isLen(t.name)?e:e+1,0)}getMethod(e){return this.abi.find(t=>t.name===e)}getLegacyFormat(){return this.abi}},th=class{abi;constructor(e){this.abi=e}methodInputsLength(e){return e.inputs.length}getMethod(e){let t=this.abi.find(e=>"interface"===e.type);return t.items.find(t=>t.name===e)}getLegacyFormat(){return this.abi.flatMap(e=>"interface"===e.type?e.items:e)}};function createAbiParser(e){let t=e.find(e=>"interface"===e.type)?2:isCairo1Abi(e)?1:0;if(0===t||1===t)return new tu(e);if(2===t)return new th(e);throw Error(`Unsupported ABI version ${t}`)}function isNoConstructorValid(e,t,a){return"constructor"===e&&!a&&!t.length}function getClosureOffset(e,t,a){for(let r=0,n=0;r<e.length;r++)if(e[r]===t)n++;else if(e[r]===a&&0==--n)return r;return Number.POSITIVE_INFINITY}function extractTupleMemberTypes(e){return isCairo1Type(e)?function(e){let t;let a=e.slice(1,-1),r=[],n=0;for(;n<a.length;){switch(!0){case"("===a[n]:t=n+getClosureOffset(a.slice(n),"(",")")+1;break;case a.startsWith("core::result::Result::<",n)||a.startsWith("core::array::Array::<",n)||a.startsWith("core::option::Option::<",n):t=n+getClosureOffset(a.slice(n),"<",">")+1;break;default:{let e=a.indexOf(",",n);t=-1!==e?e:Number.POSITIVE_INFINITY}}r.push(a.slice(n,t)),n=t+2}return r}(e):function(e){let t=e.replace(/\s/g,"").slice(1,-1),{subTuple:a,result:r}=function(e){if(!e.includes("("))return{subTuple:[],result:e};let t=[],a="",r=0;for(;r<e.length;){if("("===e[r]){let n=1,i=r;for(r++;n;)")"===e[r]&&n--,"("===e[r]&&n++,r++;t.push(e.substring(i,r)),a+=" ",r--}else a+=e[r];r++}return{subTuple:t,result:a}}(t),n=r.split(",").map(e=>a.length?e.replace(" ",a.shift()):e);return isTypeNamedTuple(e)&&(n=n.reduce((e,t)=>e.concat(function(e){let t=e.substring(0,e.indexOf(":")),a=e.substring(t.length+1);return{name:t,type:a}}(t)),[])),n}(e)}function parseBaseTypes(e,t){switch(!0){case te.isAbiType(e):return new te(t).toApiRequest();case tn.isAbiType(e):return new tn(t).toApiRequest();case isTypeBytes31(e):return encodeShortString(t.toString());case isTypeSecp256k1Point(e):{let e=removeHexPrefix(toHex(t)).padStart(128,"0"),a=uint256(addHexPrefix(e.slice(-64))),r=uint256(addHexPrefix(e.slice(0,-64)));return[CairoFelt(r.low),CairoFelt(r.high),CairoFelt(a.low),CairoFelt(a.high)]}default:return CairoFelt(t)}}function parseCalldataValue(e,t,a,r){if(void 0===e)throw Error(`Missing parameter for type ${t}`);if(Array.isArray(e)){let n=[];n.push(CairoFelt(e.length));let i=getArrayType(t);return e.reduce((e,t)=>e.concat(parseCalldataValue(t,i,a,r)),n)}if(a[t]&&a[t].members.length){if(te.isAbiType(t))return new te(e).toApiRequest();if(tn.isAbiType(t))return new tn(e).toApiRequest();if("core::starknet::eth_address::EthAddress"===t)return parseBaseTypes(t,e);if("core::byte_array::ByteArray"===t)return function(e){let t=byteArrayFromString(e);return[t.data.length.toString(),...t.data.map(e=>e.toString()),t.pending_word.toString(),t.pending_word_len.toString()]}(e);let{members:n}=a[t];return n.reduce((t,n)=>t.concat(parseCalldataValue(e[n.name],n.type,a,r)),[])}if(isTypeTuple(t)){let n=function(e,t){let a=extractTupleMemberTypes(t),r=Object.values(e);if(r.length!==a.length)throw Error(`ParseTuple: provided and expected abi tuple size do not match.
      provided: ${r} 
      expected: ${a}`);return a.map((e,t)=>({element:r[t],type:e.type??e}))}(e,t);return n.reduce((e,t)=>{let n=parseCalldataValue(t.element,t.type,a,r);return e.concat(n)},[])}if(te.isAbiType(t))return new te(e).toApiRequest();if(tn.isAbiType(t))return new tn(e).toApiRequest();if(isTypeEnum(t,r)){let{variants:n}=r[t];if(isTypeOption(t)){if(e.isSome()){let t=n.find(e=>"Some"===e.name);if(void 0===t)throw Error("Error in abi : Option has no 'Some' variant.");let i=t.type;if("()"===i)return"0";let s=parseCalldataValue(e.unwrap(),i,a,r);return Array.isArray(s)?["0",...s]:["0",s]}return"1"}if(isTypeResult(t)){if(e.isOk()){let t=n.find(e=>"Ok"===e.name);if(void 0===t)throw Error("Error in abi : Result has no 'Ok' variant.");let i=t.type;if("()"===i)return"0";let s=parseCalldataValue(e.unwrap(),i,a,r);return Array.isArray(s)?["0",...s]:["0",s]}let t=n.find(e=>"Err"===e.name);if(void 0===t)throw Error("Error in abi : Result has no 'Err' variant.");let i=t.type;if("()"===i)return"1";let s=parseCalldataValue(e.unwrap(),i,a,r);return Array.isArray(s)?["1",...s]:["1",s]}let i=e.activeVariant(),s=n.find(e=>e.name===i);if(void 0===s)throw Error(`Not find in abi : Enum has no '${i}' variant.`);let o=s.type,c=n.findIndex(e=>e.name===i);if("()"===o)return c.toString();let l=parseCalldataValue(e.unwrap(),o,a,r);return Array.isArray(l)?[c.toString(),...l]:[c.toString(),l]}if(isTypeNonZero(t))return parseBaseTypes(getArrayType(t),e);if("object"==typeof e)throw Error(`Parameter ${e} do not align with abi parameter ${t}`);return parseBaseTypes(t,e)}function parseCalldataField(e,t,a,r){let{name:n,type:i}=t,{value:s}=e.next();switch(!0){case isTypeArray(i):if(!Array.isArray(s)&&!isText(s))throw Error(`ABI expected parameter ${n} to be array or long string, got ${s}`);return isString(s)&&(s=splitLongString(s)),parseCalldataValue(s,t.type,a,r);case isTypeNonZero(i):return parseBaseTypes(getArrayType(i),s);case"core::starknet::eth_address::EthAddress"===i:return parseBaseTypes(i,s);case isTypeStruct(i,a)||isTypeTuple(i)||te.isAbiType(i)||te.isAbiType(i):case isTypeEnum(i,r):return parseCalldataValue(s,i,a,r);default:return parseBaseTypes(i,s)}}function parseBaseTypes2(e,t){switch(!0){case isTypeBool(e):return!!BigInt(t.next().value);case te.isAbiType(e):let a=t.next().value,r=t.next().value;return new te(a,r).toBigInt();case tn.isAbiType(e):let n=t.next().value,i=t.next().value,s=t.next().value,o=t.next().value;return new tn(n,i,s,o).toBigInt();case"core::starknet::eth_address::EthAddress"===e:return BigInt(t.next().value);case"core::bytes_31::bytes31"===e:return decodeShortString(t.next().value);case isTypeSecp256k1Point(e):let c=removeHexPrefix(t.next().value).padStart(32,"0"),l=removeHexPrefix(t.next().value).padStart(32,"0"),d=removeHexPrefix(t.next().value).padStart(32,"0"),u=removeHexPrefix(t.next().value).padStart(32,"0"),h=BigInt(addHexPrefix(l+c+u+d));return h;default:return BigInt(t.next().value)}}function parseResponseValue(e,t,a,r){if("()"===t.type)return{};if(te.isAbiType(t.type)){let t=e.next().value,a=e.next().value;return new te(t,a).toBigInt()}if(tn.isAbiType(t.type)){let t=e.next().value,a=e.next().value,r=e.next().value,n=e.next().value;return new tn(t,a,r,n).toBigInt()}if(isTypeByteArray(t.type)){let t=[],a=BigInt(e.next().value);for(;t.length<a;)t.push(toHex(e.next().value));let r=toHex(e.next().value),n=BigInt(e.next().value);return stringFromByteArray({data:t,pending_word:r,pending_word_len:n})}if(isTypeArray(t.type)){let n=[],i={name:"",type:getArrayType(t.type)},s=BigInt(e.next().value);for(;n.length<s;)n.push(parseResponseValue(e,i,a,r));return n}if(isTypeNonZero(t.type)){let n={name:"",type:getArrayType(t.type)};return parseResponseValue(e,n,a,r)}if(a&&t.type in a&&a[t.type])return"core::starknet::eth_address::EthAddress"===t.type?parseBaseTypes2(t.type,e):a[t.type].members.reduce((t,n)=>(t[n.name]=parseResponseValue(e,n,a,r),t),{});if(r&&t.type in r&&r[t.type]){let n=Number(e.next().value),i=r[t.type].variants.reduce((t,i,s)=>(s===n?t[i.name]=parseResponseValue(e,{name:"",type:i.type},a,r):t[i.name]=void 0,t),{});if(t.type.startsWith("core::option::Option")){let e=0===n?i.Some:void 0;return new to(n,e)}if(t.type.startsWith("core::result::Result")){let e;return e=0===n?i.Ok:i.Err,new tl(n,e)}let s=new ti(i);return s}if(isTypeTuple(t.type)){let n=extractTupleMemberTypes(t.type);return n.reduce((t,n,i)=>{let s=n?.name?n.name:i,o=n?.type?n.type:n;return t[s]=parseResponseValue(e,{name:s,type:o},a,r),t},{})}if(isTypeArray(t.type)){let n=[],i={name:"",type:getArrayType(t.type)},s=BigInt(e.next().value);for(;n.length<s;)n.push(parseResponseValue(e,i,a,r));return n}return parseBaseTypes2(t.type,e)}function responseParser(e,t,a,r,n){let{name:i,type:s}=t;switch(!0){case isLen(i):return BigInt(e.next().value);case a&&s in a||isTypeTuple(s):case r&&isTypeEnum(s,r):return parseResponseValue(e,t,a,r);case isTypeArray(s):if(isCairo1Type(s))return parseResponseValue(e,t,a,r);let o=[];if(n&&n[`${i}_len`]){let s=n[`${i}_len`];for(;o.length<s;)o.push(parseResponseValue(e,{name:i,type:t.type.replace("*","")},a,r))}return o;case isTypeNonZero(s):return parseResponseValue(e,t,a,r);default:return parseBaseTypes2(s,e)}}var validateFelt=(e,t)=>{if(assert(isString(e)||isNumber(e)||isBigInt(e),`Validate: arg ${t.name} should be a felt typed as (String, Number or BigInt)`),isString(e)&&!isHex(e))return;let a=BigInt(e.toString(10));assert(a>=0n&&a<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`)},validateBytes31=(e,t)=>{assert(isString(e),`Validate: arg ${t.name} should be a string.`),assert(e.length<32,`Validate: arg ${t.name} cairo typed ${t.type} should be a string of less than 32 characters.`)},validateByteArray=(e,t)=>{assert(isString(e),`Validate: arg ${t.name} should be a string.`)},validateUint=(e,t)=>{let a;switch(isNumber(e)&&assert(e<=Number.MAX_SAFE_INTEGER,"Validation: Parameter is to large to be typed as Number use (BigInt or String)"),assert(isString(e)||isNumber(e)||isBigInt(e)||"object"==typeof e&&"low"in e&&"high"in e||"object"==typeof e&&["limb0","limb1","limb2","limb3"].every(t=>t in e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (String, Number or BigInt), but is ${typeof e} ${e}.`),t.type){case"core::integer::u256":a=new te(e).toBigInt();break;case"core::integer::u512":a=new tn(e).toBigInt();break;default:a=toBigInt(e)}switch(t.type){case"core::integer::u8":assert(a>=0n&&a<=255n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0 - 255]`);break;case"core::integer::u16":assert(a>=0n&&a<=65535n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 65535]`);break;case"core::integer::u32":assert(a>=0n&&a<=4294967295n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 4294967295]`);break;case"core::integer::u64":assert(a>=0n&&a<=2n**64n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^64-1]`);break;case"core::integer::u128":assert(a>=0n&&a<=2n**128n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^128-1]`);break;case"core::integer::u256":assert(a>=0n&&a<=2n**256n-1n,`Validate: arg ${t.name} is ${t.type} 0 - 2^256-1`);break;case"core::integer::u512":assert(tn.is(a),`Validate: arg ${t.name} is ${t.type} 0 - 2^512-1`);break;case"core::starknet::class_hash::ClassHash":case"core::starknet::contract_address::ContractAddress":assert(a>=0n&&a<=2n**252n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^252-1]`);break;case"core::starknet::secp256k1::Secp256k1Point":assert(a>=0n&&a<=2n**512n-1n,`Validate: arg ${t.name} must be ${t.type} : a 512 bits number.`)}},validateBool=(e,t)=>{assert(isBoolean(e),`Validate: arg ${t.name} of cairo type ${t.type} should be type (Boolean)`)},validateStruct=(e,t,a)=>{if("core::integer::u256"===t.type||"core::integer::u512"===t.type){validateUint(e,t);return}if("core::starknet::eth_address::EthAddress"===t.type){assert("object"!=typeof e,`EthAddress type is waiting a BigNumberish. Got ${e}`);let a=BigInt(e.toString(10));assert(a>=0n&&a<=2n**160n-1n,`Validate: arg ${t.name} cairo typed ${t.type} should be in range [0, 2^160-1]`);return}assert("object"==typeof e&&!Array.isArray(e),`Validate: arg ${t.name} is cairo type struct (${t.type}), and should be defined as js object (not array)`),a[t.type].members.forEach(({name:a})=>{assert(Object.keys(e).includes(a),`Validate: arg ${t.name} should have a property ${a}`)})},validateEnum=(e,t)=>{assert("object"==typeof e&&!Array.isArray(e),`Validate: arg ${t.name} is cairo type Enum (${t.type}), and should be defined as js object (not array)`);let a=Object.getOwnPropertyNames(Object.getPrototypeOf(e)),r=[...Object.getOwnPropertyNames(e),...a];if(!(isTypeOption(t.type)&&r.includes("isSome")&&r.includes("isNone")||isTypeResult(t.type)&&r.includes("isOk")&&r.includes("isErr")||r.includes("variant")&&r.includes("activeVariant")))throw Error(`Validate Enum: argument ${t.name}, type ${t.type}, value received ${e}, is not an Enum.`)},validateTuple=(e,t)=>{assert("object"==typeof e&&!Array.isArray(e),`Validate: arg ${t.name} should be a tuple (defined as object)`)},validateArray=(e,t,a,r)=>{let n=getArrayType(t.type);if(!(isTypeFelt(n)&&isLongText(e)))switch(assert(Array.isArray(e),`Validate: arg ${t.name} should be an Array`),!0){case isTypeFelt(n):e.forEach(e=>validateFelt(e,t));break;case isTypeTuple(n):e.forEach(e=>validateTuple(e,{name:t.name,type:n}));break;case isTypeArray(n):e.forEach(e=>validateArray(e,{name:"",type:n},a,r));break;case isTypeStruct(n,a):e.forEach(e=>validateStruct(e,{name:t.name,type:n},a));break;case isTypeEnum(n,r):e.forEach(e=>validateEnum(e,{name:t.name,type:n}));break;case isTypeUint(n)||isTypeLiteral(n):e.forEach(e=>validateUint(e,{name:"",type:n}));break;case isTypeBool(n):e.forEach(e=>validateBool(e,t));break;default:throw Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value ${e}`)}},validateNonZero=(e,t)=>{let a=getArrayType(t.type);switch(assert(isTypeUint(a)&&a!==tn.abiSelector||isTypeFelt(a),`Validate: ${t.name} type is not authorized for NonZero type.`),!0){case isTypeFelt(a):validateFelt(e,t),assert(BigInt(e.toString(10))>0,"Validate: value 0 is not authorized in NonZero felt252 type.");break;case isTypeUint(a):(validateUint(e,{name:"",type:a}),"core::integer::u256"===t.type)?assert(new te(e).toBigInt()>0,"Validate: value 0 is not authorized in NonZero uint256 type."):assert(toBigInt(e)>0,"Validate: value 0 is not authorized in NonZero uint type.");break;default:throw Error(`Validate Unhandled: argument ${t.name}, type ${t.type}, value ${e}`)}};function validateFields(e,t,a,r){e.inputs.reduce((e,n)=>{let i=t[e];switch(!0){case isLen(n.name):return e;case isTypeFelt(n.type):validateFelt(i,n);break;case isTypeBytes31(n.type):validateBytes31(i,n);break;case isTypeUint(n.type)||isTypeLiteral(n.type):validateUint(i,n);break;case isTypeBool(n.type):validateBool(i,n);break;case isTypeByteArray(n.type):validateByteArray(i,n);break;case isTypeArray(n.type):validateArray(i,n,a,r);break;case isTypeStruct(n.type,a):validateStruct(i,n,a);break;case isTypeEnum(n.type,r):validateEnum(i,n);break;case isTypeTuple(n.type):validateTuple(i,n);break;case isTypeNonZero(n.type):validateNonZero(i,n);break;default:throw Error(`Validate Unhandled: argument ${n.name}, type ${n.type}, value ${i}`)}return e+1},0)}var tp=class _CallData{abi;parser;structs;enums;constructor(e){this.structs=_CallData.getAbiStruct(e),this.enums=_CallData.getAbiEnum(e),this.parser=createAbiParser(e),this.abi=this.parser.getLegacyFormat()}validate(e,t,a=[]){if("DEPLOY"!==e){let a=this.abi.filter(t=>{if("function"!==t.type)return!1;let a="view"===t.stateMutability||"view"===t.state_mutability;return"INVOKE"===e?!a:a}).map(e=>e.name);assert(a.includes(t),`${"INVOKE"===e?"invocable":"viewable"} method not found in abi`)}let r=this.abi.find(a=>"DEPLOY"===e?a.name===t&&"constructor"===a.type:a.name===t&&"function"===a.type);if(isNoConstructorValid(t,a,r))return;let n=this.parser.methodInputsLength(r);if(a.length!==n)throw Error(`Invalid number of arguments, expected ${n} arguments, but got ${a.length}`);validateFields(r,a,this.structs,this.enums)}compile(e,t){let a;let r=this.abi.find(t=>t.name===e);if(isNoConstructorValid(e,t,r))return[];if(Array.isArray(t))a=t;else{let e=function(e,t,a,r){let orderInput=(e,t)=>{if(isTypeArray(t))return function(e,t){let a=getArrayType(t);return isString(e)?e:e.map(e=>orderInput(e,a))}(e,t);if(isTypeEnum(t,r)){let a=r[t];return orderEnum(e,a)}if(isTypeTuple(t))return function(e,t){let a=extractTupleMemberTypes(t),r=a.reduce((t,a,r)=>{var n;let i=Object.keys(e),s=a?.type?a.type:a;return n=orderInput(e[i[r]],s),Object.defineProperty(t,r.toString(),{enumerable:!0,value:n??e[i[r]]}),t},{});return r}(e,t);if(isTypeEthAddress(t)||isTypeNonZero(t)||isTypeByteArray(t)||isTypeSecp256k1Point(t))return e;if(te.isAbiType(t)){if("object"!=typeof e)return e;if(!("low"in e&&"high"in e))throw Error(`Your object includes the property : ${t}, containing an Uint256 object without the 'low' and 'high' keys.`);return{low:e.low,high:e.high}}if(tn.isAbiType(t)){if("object"!=typeof e)return e;if(!["limb0","limb1","limb2","limb3"].every(t=>t in e))throw Error(`Your object includes the property : ${t}, containing an Uint512 object without the 'limb0' to 'limb3' keys.`);return{limb0:e.limb0,limb1:e.limb1,limb2:e.limb2,limb3:e.limb3}}if(isTypeStruct(t,a)){let r=a[t].members;return orderStruct(e,r)}return e},orderStruct=(e,t)=>{let a=t.reduce((t,a)=>{var r;if("undefined"===e[a.name]&&(isCairo1Type(a.type)||!isLen(a.name)))throw Error(`Your object needs a property with key : ${a.name} .`);return r=orderInput(e[a.name],a.type),Object.defineProperty(t,a.name,{enumerable:!0,value:r??e[a.name]}),t},{});return a},orderEnum=(e,t)=>{if(isTypeResult(t.name)){let a=t.name.substring(t.name.indexOf("<")+1,t.name.lastIndexOf(",")),r=t.name.substring(t.name.indexOf(",")+1,t.name.lastIndexOf(">"));return e.isOk()?new tl(0,orderInput(e.unwrap(),a)):new tl(1,orderInput(e.unwrap(),r))}if(isTypeOption(t.name)){let a=t.name.substring(t.name.indexOf("<")+1,t.name.lastIndexOf(">"));return e.isSome()?new to(0,orderInput(e.unwrap(),a)):new to(1,{})}let a=Object.entries(e.variant),r=a.map(a=>{if(void 0===a[1])return a;let r=t.type.substring(t.type.lastIndexOf("<")+1,t.type.lastIndexOf(">"));return"()"===r?a:[a[0],orderInput(e.unwrap(),r)]});return new ti(Object.fromEntries(r))},n=t.reduce((t,a)=>{var r;return isLen(a.name)&&!isCairo1Type(a.type)||(r=orderInput(e[a.name],a.type),Object.defineProperty(t,a.name,{enumerable:!0,value:r})),t},{});return n}(t,r.inputs,this.structs,this.enums);validateFields(r,a=Object.values(e),this.structs,this.enums)}let n=a[Symbol.iterator](),i=r.inputs.reduce((e,t)=>isLen(t.name)&&!isCairo1Type(t.type)?e:e.concat(parseCalldataField(n,t,this.structs,this.enums)),[]);return Object.defineProperty(i,"__compiled__",{enumerable:!1,writable:!1,value:!0}),i}static compile(e){let t;let createTree=e=>{let getEntries=(e,t=".")=>{let a=Array.isArray(e)?[e.length.toString(),...e]:e;return Object.entries(a).flatMap(([e,r])=>{let n=r;"entrypoint"===e?n=getSelectorFromName(n):isLongText(n)&&(n=byteArrayFromString(n));let i=Array.isArray(a)&&"0"===e?"$$len":e;if(isBigInt(n))return[[`${t}${i}`,CairoFelt(n)]];if(Object(n)===n){let e=Object.getOwnPropertyNames(Object.getPrototypeOf(n)),a=[...Object.getOwnPropertyNames(n),...e];if(a.includes("isSome")&&a.includes("isNone")){let e=n,a=e.isSome()?0:1;return e.isSome()?getEntries({0:a,1:e.unwrap()},`${t}${i}.`):[[`${t}${i}`,CairoFelt(a)]]}if(a.includes("isOk")&&a.includes("isErr")){let e=n,a=e.isOk()?0:1;return getEntries({0:a,1:e.unwrap()},`${t}${i}.`)}if(a.includes("variant")&&a.includes("activeVariant")){let e=n,a=e.activeVariant(),r=Object.keys(e.variant),s=r.findIndex(e=>e===a);return"object"==typeof e.unwrap()&&0===Object.keys(e.unwrap()).length?[[`${t}${i}`,CairoFelt(s)]]:getEntries({0:s,1:e.unwrap()},`${t}${i}.`)}return getEntries(n,`${t}${i}.`)}return[[`${t}${i}`,CairoFelt(n)]]})},t=Object.fromEntries(getEntries(e));return t};if(Array.isArray(e)){let a={...e},r=createTree(a);t=Object.values(r)}else{let a=createTree(e);t=Object.values(a)}return Object.defineProperty(t,"__compiled__",{enumerable:!1,writable:!1,value:!0}),t}parse(e,t){let{outputs:a}=this.abi.find(t=>t.name===e),r=t.flat()[Symbol.iterator](),n=a.flat().reduce((e,t,a)=>{let n=t.name??a;return e[n]=responseParser(r,t,this.structs,this.enums,e),e[n]&&e[`${n}_len`]&&delete e[`${n}_len`],e},{});return 1===Object.keys(n).length&&0 in n?n[0]:n}format(e,t,a){let r=this.parse(e,t);return function formatter(e,t,a){return Object.entries(e).reduce((r,[n,i])=>{let s=a??t[n];if(!(n in t)&&!a)return r[n]=i,r;if("string"===s){if(Array.isArray(e[n])){let t=formatter(e[n],e[n].map(e=>s));return r[n]=Object.values(t).join(""),r}return td.isBN(e,t,n),r[n]=decodeShortString(i),r}if("number"===s)return td.isBN(e,t,n),r[n]=Number(i),r;if("function"==typeof s)return r[n]=s(i),r;if(Array.isArray(s)){let t=formatter(e[n],s,s[0]);return r[n]=Object.values(t),r}return"object"==typeof s?r[n]=formatter(e[n],s):td.unknown(e,t,n),r},{})}(r,a)}static getAbiStruct(e){return e.filter(e=>"struct"===e.type).reduce((e,t)=>({...e,[t.name]:t}),{})}static getAbiEnum(e){let t=e.filter(e=>"enum"===e.type).reduce((e,t)=>({...e,[t.name]:t}),{});return delete t["core::bool"],t}static toCalldata(e=[]){return _CallData.compile(e)}static toHex(e=[]){let t=_CallData.compile(e);return t.map(e=>toHex(e))}decodeParameters(e,t){let a=Array.isArray(e)?e:[e],r=t.flat()[Symbol.iterator](),n=a.map(e=>responseParser(r,{name:"",type:e},this.structs,this.enums));return 1===n.length?n[0]:n}},tg={};__export(tg,{calculateContractAddressFromHash:()=>calculateContractAddressFromHash,calculateDeclareTransactionHash:()=>calculateDeclareTransactionHash3,calculateDeployAccountTransactionHash:()=>calculateDeployAccountTransactionHash3,calculateInvokeTransactionHash:()=>calculateInvokeTransactionHash2,computeCompiledClassHash:()=>computeCompiledClassHash,computeContractClassHash:()=>computeContractClassHash,computeHashOnElements:()=>computeHashOnElements2,computeHintedClassHash:()=>computeHintedClassHash,computeLegacyContractClassHash:()=>computeLegacyContractClassHash,computePedersenHash:()=>computePedersenHash,computePedersenHashOnElements:()=>tH,computePoseidonHash:()=>computePoseidonHash,computePoseidonHashOnElements:()=>computePoseidonHashOnElements,computeSierraContractClassHash:()=>computeSierraContractClassHash,formatSpaces:()=>formatSpaces,getSelector:()=>getSelector,getSelectorFromName:()=>getSelectorFromName,hashByteCodeSegments:()=>hashByteCodeSegments,keccakBn:()=>keccakBn,poseidon:()=>ty,starknetKeccak:()=>starknetKeccak});var ty=__toESM(a(67616)),tf={};__export(tf,{calculateDeclareTransactionHash:()=>calculateDeclareTransactionHash,calculateDeployAccountTransactionHash:()=>calculateDeployAccountTransactionHash,calculateTransactionHash:()=>calculateTransactionHash,calculateTransactionHashCommon:()=>calculateTransactionHashCommon,computeHashOnElements:()=>computeHashOnElements});var tm={};__export(tm,{starkCurve:()=>tT,weierstrass:()=>t_});var tT=__toESM(a(38906)),t_=__toESM(a(35934));function computeHashOnElements(e){return[...e,e.length].reduce((e,t)=>tT.pedersen(toBigInt(e),toBigInt(t)),0).toString()}function calculateTransactionHashCommon(e,t,a,r,n,i,s,o=[]){let c=computeHashOnElements(n),l=[e,t,a,r,c,i,s,...o];return computeHashOnElements(l)}function calculateDeclareTransactionHash(e,t,a,r,n,i,s){return calculateTransactionHashCommon("0x6465636c617265",a,t,0,[e],r,n,[i,...s?[s]:[]])}function calculateDeployAccountTransactionHash(e,t,a,r,n,i,s,o){let c=[t,r,...a];return calculateTransactionHashCommon("0x6465706c6f795f6163636f756e74",n,e,0,c,i,s,[o])}function calculateTransactionHash(e,t,a,r,n,i){return calculateTransactionHashCommon("0x696e766f6b65",t,e,0,a,r,n,[i])}var tE={};__export(tE,{calculateDeclareTransactionHash:()=>calculateDeclareTransactionHash2,calculateDeployAccountTransactionHash:()=>calculateDeployAccountTransactionHash2,calculateInvokeTransactionHash:()=>calculateInvokeTransactionHash,calculateTransactionHashCommon:()=>calculateTransactionHashCommon2,hashDAMode:()=>hashDAMode,hashFeeField:()=>hashFeeField});var tb=a(38906),AToBI=e=>e.map(e=>BigInt(e)),tv=64n+128n,tA=BigInt(encodeShortString("L1_GAS")),tC=BigInt(encodeShortString("L2_GAS"));function hashDAMode(e,t){return(BigInt(e)<<32n)+BigInt(t)}function hashFeeField(e,t){let a=(tA<<tv)+(BigInt(t.l1_gas.max_amount)<<128n)+BigInt(t.l1_gas.max_price_per_unit),r=(tC<<tv)+(BigInt(t.l2_gas.max_amount)<<128n)+BigInt(t.l2_gas.max_price_per_unit);return(0,tb.poseidonHashMany)([BigInt(e),a,r])}function calculateTransactionHashCommon2(e,t,a,r,n,i,s,o,c,l,d=[]){let u=hashFeeField(i,l),h=hashDAMode(o,c),p=AToBI([e,t,a,u,(0,tb.poseidonHashMany)(AToBI(s)),r,n,h,...AToBI(d)]);return toHex((0,tb.poseidonHashMany)(p))}function calculateDeployAccountTransactionHash2(e,t,a,r,n,i,s,o,c,l,d,u){return calculateTransactionHashCommon2("0x6465706c6f795f6163636f756e74",n,e,i,s,d,u,o,c,l,[(0,tb.poseidonHashMany)(AToBI(a)),t,r])}function calculateDeclareTransactionHash2(e,t,a,r,n,i,s,o,c,l,d,u){return calculateTransactionHashCommon2("0x6465636c617265",r,a,n,i,d,AToBI(u),o,c,l,[(0,tb.poseidonHashMany)(AToBI(s)),e,t])}function calculateInvokeTransactionHash(e,t,a,r,n,i,s,o,c,l,d){return calculateTransactionHashCommon2("0x696e766f6b65",t,e,r,n,l,d,s,o,c,[(0,tb.poseidonHashMany)(AToBI(i)),(0,tb.poseidonHashMany)(AToBI(a))])}function calculateInvokeTransactionHash2(e){return[W.ETransactionVersion.V3,W.ETransactionVersion.F3].includes(e.version)?calculateInvokeTransactionHash(e.senderAddress,e.version,e.compiledCalldata,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):calculateTransactionHash(e.senderAddress,e.version,e.compiledCalldata,e.maxFee,e.chainId,e.nonce)}function calculateDeclareTransactionHash3(e){return[W.ETransactionVersion.V3,W.ETransactionVersion.F3].includes(e.version)?calculateDeclareTransactionHash2(e.classHash,e.compiledClassHash,e.senderAddress,e.version,e.chainId,e.nonce,e.accountDeploymentData,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):calculateDeclareTransactionHash(e.classHash,e.senderAddress,e.version,e.maxFee,e.chainId,e.nonce,e.compiledClassHash)}function calculateDeployAccountTransactionHash3(e){return[W.ETransactionVersion.V3,W.ETransactionVersion.F3].includes(e.version)?calculateDeployAccountTransactionHash2(e.contractAddress,e.classHash,e.compiledConstructorCalldata,e.salt,e.version,e.chainId,e.nonce,e.nonceDataAvailabilityMode,e.feeDataAvailabilityMode,e.resourceBounds,e.tip,e.paymasterData):calculateDeployAccountTransactionHash(e.contractAddress,e.classHash,e.constructorCalldata,e.salt,e.version,e.maxFee,e.chainId,e.nonce)}var tx=a(38906),tS={};__export(tS,{parse:()=>parse2,parseAlwaysAsBig:()=>parseAlwaysAsBig,stringify:()=>stringify2,stringifyAlwaysAsBig:()=>tk});var tI=__toESM(a(56138)),parseIntAsNumberOrBigInt=e=>{if(!tI.isInteger(e))return parseFloat(e);let t=parseInt(e,10);return Number.isSafeInteger(t)?t:BigInt(e)},parse2=e=>tI.parse(String(e),void 0,parseIntAsNumberOrBigInt),parseAlwaysAsBig=e=>tI.parse(String(e),void 0,tI.parseNumberAndBigInt),stringify2=(e,t,a,r)=>tI.stringify(e,t,a,r),tk=stringify2;function computePedersenHash(e,t){return tT.pedersen(BigInt(e),BigInt(t))}function computePoseidonHash(e,t){return toHex(tT.poseidonHash(BigInt(e),BigInt(t)))}function computeHashOnElements2(e){return[...e,e.length].reduce((e,t)=>tT.pedersen(BigInt(e),BigInt(t)),0).toString()}var tH=computeHashOnElements2;function computePoseidonHashOnElements(e){return toHex((0,tx.poseidonHashMany)(e.map(e=>BigInt(e))))}function calculateContractAddressFromHash(e,t,a,r){let n=tp.compile(a),i=computeHashOnElements2(n),s=CairoFelt("0x535441524b4e45545f434f4e54524143545f41444452455353"),o=computeHashOnElements2([s,r,e,t,i]);return toHex(BigInt(o)%eT)}function nullSkipReplacer(e,t){return"attributes"===e||"accessible_scopes"===e?Array.isArray(t)&&0===t.length?void 0:t:"debug_info"===e?null:null===t?void 0:t}function formatSpaces(e){let t=!1,a=[];for(let r of e)'"'===r&&!1==(a.length>0&&"\\"===a.slice(-1)[0])&&(t=!t),t?a.push(r):a.push(":"===r?": ":","===r?", ":r);return a.join("")}function computeHintedClassHash(e){let{abi:t,program:a}=e,r=formatSpaces(stringify2({abi:t,program:a},nullSkipReplacer));return addHexPrefix(tT.keccak(utf8ToArray(r)).toString(16))}function computeLegacyContractClassHash(e){let t=isString(e)?parse2(e):e,a=toHex(ey),r=computeHashOnElements2(t.entry_points_by_type.EXTERNAL.flatMap(e=>[e.selector,e.offset])),n=computeHashOnElements2(t.entry_points_by_type.L1_HANDLER.flatMap(e=>[e.selector,e.offset])),i=computeHashOnElements2(t.entry_points_by_type.CONSTRUCTOR.flatMap(e=>[e.selector,e.offset])),s=computeHashOnElements2(t.program.builtins.map(e=>encodeShortString(e))),o=computeHintedClassHash(t),c=computeHashOnElements2(t.program.data);return computeHashOnElements2([a,r,n,i,s,o,c])}function hashEntryPoint(e){let t=e.flatMap(e=>{var t;return[BigInt(e.selector),BigInt(e.offset),(t=e.builtins,(0,tx.poseidonHashMany)(t.flatMap(e=>BigInt(encodeShortString(e)))))]});return(0,tx.poseidonHashMany)(t)}function hashByteCodeSegments(e){let t=e.bytecode.map(e=>BigInt(e)),a=e.bytecode_segment_lengths??[],r=0,n=a.flatMap(e=>{let a=t.slice(r,r+=e);return[BigInt(e),(0,tx.poseidonHashMany)(a)]});return 1n+(0,tx.poseidonHashMany)(n)}function computeCompiledClassHash(e){let t=BigInt(encodeShortString("COMPILED_CLASS_V1")),a=hashEntryPoint(e.entry_points_by_type.EXTERNAL),r=hashEntryPoint(e.entry_points_by_type.L1_HANDLER),n=hashEntryPoint(e.entry_points_by_type.CONSTRUCTOR),i=e.bytecode_segment_lengths?hashByteCodeSegments(e):(0,tx.poseidonHashMany)(e.bytecode.map(e=>BigInt(e)));return toHex((0,tx.poseidonHashMany)([t,a,r,n,i]))}function hashEntryPointSierra(e){let t=e.flatMap(e=>[BigInt(e.selector),BigInt(e.function_idx)]);return(0,tx.poseidonHashMany)(t)}function computeSierraContractClassHash(e){let t=BigInt(encodeShortString("CONTRACT_CLASS_V0.1.0")),a=hashEntryPointSierra(e.entry_points_by_type.EXTERNAL),r=hashEntryPointSierra(e.entry_points_by_type.L1_HANDLER),n=hashEntryPointSierra(e.entry_points_by_type.CONSTRUCTOR),i=function(e){let t=formatSpaces(stringify2(e.abi,null));return BigInt(addHexPrefix(tT.keccak(utf8ToArray(t)).toString(16)))}(e),s=(0,tx.poseidonHashMany)(e.sierra_program.map(e=>BigInt(e)));return toHex((0,tx.poseidonHashMany)([t,a,r,n,i,s]))}function computeContractClassHash(e){let t=isString(e)?parse2(e):e;return"sierra_program"in t?computeSierraContractClassHash(t):computeLegacyContractClassHash(t)}var tw={};__export(tw,{compressProgram:()=>compressProgram,decompressProgram:()=>decompressProgram,estimateFeeToBounds:()=>estimateFeeToBounds,estimatedFeeToMaxFee:()=>estimatedFeeToMaxFee,formatSignature:()=>formatSignature,intDAM:()=>intDAM,makeAddress:()=>makeAddress,randomAddress:()=>randomAddress,reduceV2:()=>reduceV2,signatureToDecimalArray:()=>signatureToDecimalArray,signatureToHexArray:()=>signatureToHexArray,toFeeVersion:()=>toFeeVersion,toTransactionVersion:()=>toTransactionVersion,v3Details:()=>v3Details});var tD=a(38906),tV=a(25723);function compressProgram(e){let t=isString(e)?e:stringify2(e),a=(0,tV.gzip)(t);return btoaUniversal(a)}function decompressProgram(e){if(Array.isArray(e))return e;let t=arrayBufferToString((0,tV.ungzip)(atobUniversal(e)));return parse2(t)}function randomAddress(){let e=tD.utils.randomPrivateKey();return(0,tD.getStarkKey)(e)}function makeAddress(e){return addHexPrefix(e).toLowerCase()}function formatSignature(e){if(!e)throw Error("formatSignature: provided signature is undefined");if(Array.isArray(e))return e.map(e=>toHex(e));try{let{r:t,s:a}=e;return[toHex(t),toHex(a)]}catch(e){throw Error("Signature need to be weierstrass.SignatureType or an array for custom")}}function signatureToDecimalArray(e){return bigNumberishArrayToDecimalStringArray(formatSignature(e))}function signatureToHexArray(e){return bigNumberishArrayToHexadecimalStringArray(formatSignature(e))}function estimatedFeeToMaxFee(e,t=50){return addPercent(e,t)}function estimateFeeToBounds(e,t=50,a=50){if(isBigInt(e))return{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:"0x0",max_price_per_unit:"0x0"}};if(void 0===e.gas_consumed||void 0===e.gas_price)throw Error("estimateFeeToBounds: estimate is undefined");let r=void 0!==e.data_gas_consumed&&void 0!==e.data_gas_price?toHex(addPercent(BigInt(e.overall_fee)/BigInt(e.gas_price),t)):toHex(addPercent(e.gas_consumed,t)),n=toHex(addPercent(e.gas_price,a));return{l2_gas:{max_amount:"0x0",max_price_per_unit:"0x0"},l1_gas:{max_amount:r,max_price_per_unit:n}}}function intDAM(e){if(e===W.EDataAvailabilityMode.L1)return W.EDAMode.L1;if(e===W.EDataAvailabilityMode.L2)return W.EDAMode.L2;throw Error("EDAM conversion")}function toTransactionVersion(e,t){let a=t?toHex(t):void 0,r=toHex(e);if(t&&!Object.values(W.ETransactionVersion).includes(a))throw Error(`providedVersion ${t} is not ETransactionVersion`);if(!Object.values(W.ETransactionVersion).includes(r))throw Error(`defaultVersion ${e} is not ETransactionVersion`);return t?a:r}function toFeeVersion(e){if(!e)return;let t=toHex(e);if(t===W.ETransactionVersion.V0)return W.ETransactionVersion.F0;if(t===W.ETransactionVersion.V1)return W.ETransactionVersion.F1;if(t===W.ETransactionVersion.V2)return W.ETransactionVersion.F2;if(t===W.ETransactionVersion.V3)return W.ETransactionVersion.F3;throw Error(`toFeeVersion: ${t} is not supported`)}function v3Details(e){return{tip:e.tip||0,paymasterData:e.paymasterData||[],accountDeploymentData:e.accountDeploymentData||[],nonceDataAvailabilityMode:e.nonceDataAvailabilityMode||W.EDataAvailabilityMode.L1,feeDataAvailabilityMode:e.feeDataAvailabilityMode||W.EDataAvailabilityMode.L1,resourceBounds:e.resourceBounds??estimateFeeToBounds(ep)}}function reduceV2(e){return e===W.ETransactionVersion.F2?W.ETransactionVersion.F1:e===W.ETransactionVersion.V2?W.ETransactionVersion.V1:e}function isSierra(e){let t=isString(e)?parse2(e):e;return"sierra_program"in t}function extractContractHashes(e){let t={...e};if(isSierra(e.contract)&&(!e.compiledClassHash&&e.casm&&(t.compiledClassHash=computeCompiledClassHash(e.casm)),!t.compiledClassHash))throw Error("Extract compiledClassHash failed, provide (CairoAssembly).casm file or compiledClassHash");if(t.classHash=e.classHash??computeContractClassHash(e.contract),!t.classHash)throw Error("Extract classHash failed, provide (CompiledContract).json file or classHash");return t}function contractClassResponseToLegacyCompiledContract(e){if(isSierra(e))throw Error("ContractClassResponse need to be LegacyContractClass (cairo0 response class)");return{...e,program:decompressProgram(e.program)}}var tB={};__export(tB,{ethRandomPrivateKey:()=>ethRandomPrivateKey,validateAndParseEthAddress:()=>validateAndParseEthAddress});var tP=a(88193);function ethRandomPrivateKey(){return sanitizeHex(buf2hex(tP.secp256k1.utils.randomPrivateKey()))}function validateAndParseEthAddress(e){assertInRange(e,ep,2n**160n-1n,"Ethereum Address ");let t=addHexPrefix(removeHexPrefix(toHex(e)).padStart(40,"0"));return assert(!!t.match(/^(0x)?[0-9a-f]{40}$/),"Invalid Ethereum Address Format"),t}var tN=__toESM(a(25512)),tO=__toESM(a(94587)),tF="undefined"!=typeof window&&window.fetch||void 0!==a.g&&(0,tN.default)(a.g.fetch)||tO.default,tR={};function wait(e){return new Promise(t=>{setTimeout(t,e)})}function createSierraContractClass(e){let t={...e};return delete t.sierra_program_debug_info,t.abi=formatSpaces(stringify2(e.abi)),t.sierra_program=formatSpaces(stringify2(e.sierra_program)),t.sierra_program=compressProgram(t.sierra_program),t}function parseContract(e){let t=isString(e)?parse2(e):e;return isSierra(e)?createSierraContractClass(t):{...t,..."program"in t&&{program:compressProgram(t.program)}}}__export(tR,{Block:()=>tL,createSierraContractClass:()=>createSierraContractClass,getDefaultNodeUrl:()=>getDefaultNodeUrl,isPendingBlock:()=>isPendingBlock,isPendingStateUpdate:()=>isPendingStateUpdate,isPendingTransaction:()=>isPendingTransaction,isV3Tx:()=>isV3Tx,isVersion:()=>isVersion,parseContract:()=>parseContract,validBlockTags:()=>tM,wait:()=>wait});var getDefaultNodeUrl=(e,t=!1)=>{t||console.warn("Using default public node url, please provide nodeUrl in provider options!");let a=eH[e??"SN_SEPOLIA"],r=Math.floor(Math.random()*a.length);return a[r]},tM=Object.values(eY),tL=class{hash=null;number=null;tag=null;setIdentifier(e){if(isString(e)){if(isDecimalString(e))this.number=parseInt(e,10);else if(isHex(e))this.hash=e;else if(tM.includes(e))this.tag=e;else throw TypeError(`Block identifier unmanaged: ${e}`)}else isBigInt(e)?this.hash=toHex(e):isNumber(e)?this.number=e:this.tag="pending";if(isNumber(this.number)&&this.number<0)throw TypeError(`Block number (${this.number}) can't be negative`)}constructor(e){this.setIdentifier(e)}get queryIdentifier(){return null!==this.number?`blockNumber=${this.number}`:null!==this.hash?`blockHash=${this.hash}`:`blockNumber=${this.tag}`}get identifier(){return null!==this.number?{block_number:this.number}:null!==this.hash?{block_hash:this.hash}:this.tag}set identifier(e){this.setIdentifier(e)}valueOf=()=>this.number;toString=()=>this.hash};function isV3Tx(e){let t=e.version?toHex(e.version):W.ETransactionVersion.V3;return t===W.ETransactionVersion.V3||t===W.ETransactionVersion.F3}function isVersion(e,t){let[a,r]=e.split("."),[n,i]=t.split(".");return a===n&&r===i}function isPendingBlock(e){return"PENDING"===e.status}function isPendingTransaction(e){return!("block_hash"in e)}function isPendingStateUpdate(e){return!("block_hash"in e)}var tU={};__export(tU,{buildUDCCall:()=>buildUDCCall,fromCallsToExecuteCalldata:()=>fromCallsToExecuteCalldata,fromCallsToExecuteCalldataWithNonce:()=>fromCallsToExecuteCalldataWithNonce,fromCallsToExecuteCalldata_cairo1:()=>fromCallsToExecuteCalldata_cairo1,getExecuteCalldata:()=>getExecuteCalldata,getVersionsByType:()=>getVersionsByType,transformCallsToMulticallArrays:()=>transformCallsToMulticallArrays,transformCallsToMulticallArrays_cairo1:()=>transformCallsToMulticallArrays_cairo1});var transformCallsToMulticallArrays=e=>{let t=[],a=[];return e.forEach(e=>{let r=tp.compile(e.calldata||[]);t.push({to:toBigInt(e.contractAddress).toString(10),selector:toBigInt(getSelectorFromName(e.entrypoint)).toString(10),data_offset:a.length.toString(),data_len:r.length.toString()}),a.push(...r)}),{callArray:t,calldata:tp.compile({calldata:a})}},fromCallsToExecuteCalldata=e=>{let{callArray:t,calldata:a}=transformCallsToMulticallArrays(e),r=tp.compile({callArray:t});return[...r,...a]},fromCallsToExecuteCalldataWithNonce=(e,t)=>[...fromCallsToExecuteCalldata(e),toBigInt(t).toString()],transformCallsToMulticallArrays_cairo1=e=>{let t=e.map(e=>({to:toBigInt(e.contractAddress).toString(10),selector:toBigInt(getSelectorFromName(e.entrypoint)).toString(10),calldata:tp.compile(e.calldata||[])}));return t},fromCallsToExecuteCalldata_cairo1=e=>{let t=e.map(e=>({contractAddress:e.contractAddress,entrypoint:e.entrypoint,calldata:Array.isArray(e.calldata)&&"__compiled__"in e.calldata?e.calldata:tp.compile(e.calldata)}));return tp.compile({orderCalls:t})},getExecuteCalldata=(e,t="0")=>"1"===t?fromCallsToExecuteCalldata_cairo1(e):fromCallsToExecuteCalldata(e);function buildUDCCall(e,t){let a=[].concat(e).map(e=>{let{classHash:a,salt:r,unique:n=!0,constructorCalldata:i=[]}=e,s=tp.compile(i),o=r??randomAddress();return{call:{contractAddress:eI.ADDRESS,entrypoint:eI.ENTRYPOINT,calldata:[a,o,toCairoBool(n),s.length,...s]},address:calculateContractAddressFromHash(n?tT.pedersen(t,o):o,a,s,n?eI.ADDRESS:0)}});return{calls:a.map(e=>e.call),addresses:a.map(e=>e.address)}}function getVersionsByType(e){return"fee"===e?{v1:W.ETransactionVersion.F1,v2:W.ETransactionVersion.F2,v3:W.ETransactionVersion.F3}:{v1:W.ETransactionVersion.V1,v2:W.ETransactionVersion.V2,v3:W.ETransactionVersion.V3}}var t$={headers:{"Content-Type":"application/json"},blockIdentifier:"pending",retries:200},tj=class{nodeUrl;headers;retries;requestId;blockIdentifier;chainId;specVersion;waitMode;constructor(e){let{nodeUrl:t,retries:a,headers:r,blockIdentifier:n,chainId:i,specVersion:s,waitMode:o}=e||{};Object.values(eA).includes(t)?this.nodeUrl=getDefaultNodeUrl(t,e?.default):t?this.nodeUrl=t:this.nodeUrl=getDefaultNodeUrl(void 0,e?.default),this.retries=a||t$.retries,this.headers={...t$.headers,...r},this.blockIdentifier=n||t$.blockIdentifier,this.chainId=i,this.specVersion=s,this.waitMode=o||!1,this.requestId=0}setChainId(e){this.chainId=e}fetch(e,t,a=0){let r={id:a,jsonrpc:"2.0",method:e,...t&&{params:t}};return tF(this.nodeUrl,{method:"POST",body:stringify2(r),headers:this.headers})}errorHandler(e,t,a,r){if(a){let{code:r,message:n,data:i}=a;throw new eP(`RPC: ${e} with params ${stringify2(t,null,2)}

        ${r}: ${n}: ${stringify2(i)}`)}if(r instanceof eP)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{let a=await this.fetch(e,t,this.requestId+=1),{error:r,result:n}=await a.json();return this.errorHandler(e,t,r),n}catch(a){throw this.errorHandler(e,t,a?.response?.data,a),a}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}async getSpecVersion(){return this.specVersion??=await this.fetchEndpoint("starknet_specVersion"),this.specVersion}getNonceForAddress(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:a,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){let a=new tL(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:a,index:t})}getTransactionReceipt(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){let t=toHex(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){let{blockIdentifier:a=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:n=!0}=t,i=new tL(a).identifier,s=[];return r&&s.push(G.ESimulationFlag.SKIP_VALIDATE),n&&s.push(G.ESimulationFlag.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:i,transactions:e.map(e=>this.buildTransaction(e)),simulation_flags:s})}async waitForTransaction(e,t){let a;let r=toHex(e),{retries:n}=this,i=!1,s=!1,o=t?.retryInterval??5e3,c=t?.errorStates??[G.ETransactionStatus.REJECTED],l=t?.successStates??[G.ETransactionExecutionStatus.SUCCEEDED,G.ETransactionStatus.ACCEPTED_ON_L2,G.ETransactionStatus.ACCEPTED_ON_L1];for(;!i;){await wait(o);try{a=await this.getTransactionStatus(r);let e=a.execution_status,t=a.finality_status;if(!t){let e=Error("waiting for transaction status");throw e}if(c.includes(e)||c.includes(t)){let r=`${e}: ${t}`,n=Error(r);throw n.response=a,s=!0,n}(l.includes(e)||l.includes(t))&&(i=!0)}catch(e){if(e instanceof Error&&s)throw e;if(n<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}n-=1}let d=null;for(;null===d;){try{d=await this.getTransactionReceipt(r)}catch(e){if(n<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}n-=1,await wait(o)}return d}getStorageAt(e,t,a=this.blockIdentifier){let r=toHex(e),n=toStorageKey(t),i=new tL(a).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:n,block_id:i})}getClassHashAt(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:a})}getClass(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:a,block_id:r})}getClassAt(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:a})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:a=!0}){let r=new tL(t).identifier,n={};return isVersion("0.5",await this.getSpecVersion())||(n={simulation_flags:a?[G.ESimulationFlag.SKIP_VALIDATE]:[]}),this.fetchEndpoint("starknet_estimateFee",{request:e.map(e=>this.buildTransaction(e,"fee")),block_id:r,...n})}async invoke(e,t){let a;return a=isV3Tx(t)?this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:G.ETransactionType.INVOKE,sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),version:G.ETransactionVersion.V3,signature:signatureToHexArray(e.signature),nonce:toHex(t.nonce),resource_bounds:t.resourceBounds,tip:toHex(t.tip),paymaster_data:t.paymasterData.map(e=>toHex(e)),account_deployment_data:t.accountDeploymentData.map(e=>toHex(e)),nonce_data_availability_mode:t.nonceDataAvailabilityMode,fee_data_availability_mode:t.feeDataAvailabilityMode}}):this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),type:G.ETransactionType.INVOKE,max_fee:toHex(t.maxFee||0),version:G.ETransactionVersion.V1,signature:signatureToHexArray(e.signature),nonce:toHex(t.nonce)}}),this.waitMode?this.waitForTransaction((await a).transaction_hash):a}async declare({contract:e,signature:t,senderAddress:a,compiledClassHash:r},n){let i;if(isSierra(e)||isV3Tx(n)){if(isSierra(e)&&!isV3Tx(n))i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:G.ETransactionType.DECLARE,contract_class:{sierra_program:decompressProgram(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},compiled_class_hash:r||"",version:G.ETransactionVersion.V2,max_fee:toHex(n.maxFee||0),signature:signatureToHexArray(t),sender_address:a,nonce:toHex(n.nonce)}});else if(isSierra(e)&&isV3Tx(n))i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:G.ETransactionType.DECLARE,sender_address:a,compiled_class_hash:r||"",version:G.ETransactionVersion.V3,signature:signatureToHexArray(t),nonce:toHex(n.nonce),contract_class:{sierra_program:decompressProgram(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},resource_bounds:n.resourceBounds,tip:toHex(n.tip),paymaster_data:n.paymasterData.map(e=>toHex(e)),account_deployment_data:n.accountDeploymentData.map(e=>toHex(e)),nonce_data_availability_mode:n.nonceDataAvailabilityMode,fee_data_availability_mode:n.feeDataAvailabilityMode}});else throw Error("declare unspotted parameters")}else i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:G.ETransactionType.DECLARE,contract_class:{program:e.program,entry_points_by_type:e.entry_points_by_type,abi:e.abi},version:G.ETransactionVersion.V1,max_fee:toHex(n.maxFee||0),signature:signatureToHexArray(t),sender_address:a,nonce:toHex(n.nonce)}});return this.waitMode?this.waitForTransaction((await i).transaction_hash):i}async deployAccount({classHash:e,constructorCalldata:t,addressSalt:a,signature:r},n){let i;return i=isV3Tx(n)?this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:G.ETransactionType.DEPLOY_ACCOUNT,version:G.ETransactionVersion.V3,signature:signatureToHexArray(r),nonce:toHex(n.nonce),contract_address_salt:toHex(a||0),constructor_calldata:tp.toHex(t||[]),class_hash:toHex(e),resource_bounds:n.resourceBounds,tip:toHex(n.tip),paymaster_data:n.paymasterData.map(e=>toHex(e)),nonce_data_availability_mode:n.nonceDataAvailabilityMode,fee_data_availability_mode:n.feeDataAvailabilityMode}}):this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{constructor_calldata:tp.toHex(t||[]),class_hash:toHex(e),contract_address_salt:toHex(a||0),type:G.ETransactionType.DEPLOY_ACCOUNT,max_fee:toHex(n.maxFee||0),version:G.ETransactionVersion.V1,signature:signatureToHexArray(r),nonce:toHex(n.nonce)}}),this.waitMode?this.waitForTransaction((await i).transaction_hash):i}callContract(e,t=this.blockIdentifier){let a=new tL(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:getSelectorFromName(e.entrypoint),calldata:tp.toHex(e.calldata)},block_id:a})}estimateMessageFee(e,t=this.blockIdentifier){let{from_address:a,to_address:r,entry_point_selector:n,payload:i}=e,s={from_address:validateAndParseEthAddress(a),to_address:toHex(r),entry_point_selector:getSelector(n),payload:getHexStringArray(i)},o=new tL(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:s,block_id:o})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){let a;let r=getVersionsByType(t);if(a=isV3Tx(e)?{signature:signatureToHexArray(e.signature),nonce:toHex(e.nonce),resource_bounds:e.resourceBounds,tip:toHex(e.tip),paymaster_data:e.paymasterData.map(e=>toHex(e)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(e=>toHex(e))}:{signature:signatureToHexArray(e.signature),nonce:toHex(e.nonce),max_fee:toHex(e.maxFee||0)},"INVOKE_FUNCTION"===e.type)return{type:G.ETransactionType.INVOKE,sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),version:toHex(e.version||r.v3),...a};if("DECLARE"===e.type)return isSierra(e.contract)?{type:e.type,contract_class:{...e.contract,sierra_program:decompressProgram(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,version:toHex(e.version||r.v3),...a}:{type:e.type,contract_class:e.contract,sender_address:e.senderAddress,version:toHex(e.version||r.v1),...a};if("DEPLOY_ACCOUNT"===e.type){let{account_deployment_data:t,...n}=a;return{type:e.type,constructor_calldata:tp.toHex(e.constructorCalldata||[]),class_hash:toHex(e.classHash),contract_address_salt:toHex(e.addressSalt||0),version:toHex(e.version||r.v3),...n}}throw Error("RPC buildTransaction received unknown TransactionType")}},tq={};__export(tq,{RpcChannel:()=>tW});var tK={headers:{"Content-Type":"application/json"},blockIdentifier:"pending",retries:200},tW=class{nodeUrl;headers;retries;requestId;blockIdentifier;chainId;specVersion;transactionRetryIntervalFallback;waitMode;constructor(e){let{nodeUrl:t,retries:a,headers:r,blockIdentifier:n,chainId:i,specVersion:s,waitMode:o,transactionRetryIntervalFallback:c}=e||{};Object.values(eA).includes(t)?this.nodeUrl=getDefaultNodeUrl(t,e?.default):t?this.nodeUrl=t:this.nodeUrl=getDefaultNodeUrl(void 0,e?.default),this.retries=a||tK.retries,this.headers={...tK.headers,...r},this.blockIdentifier=n||tK.blockIdentifier,this.chainId=i,this.specVersion=s,this.waitMode=o||!1,this.requestId=0,this.transactionRetryIntervalFallback=c}get transactionRetryIntervalDefault(){return this.transactionRetryIntervalFallback??5e3}setChainId(e){this.chainId=e}fetch(e,t,a=0){let r={id:a,jsonrpc:"2.0",method:e,...t&&{params:t}};return tF(this.nodeUrl,{method:"POST",body:stringify2(r),headers:this.headers})}errorHandler(e,t,a,r){if(a){let{code:r,message:n,data:i}=a;throw new eP(`RPC: ${e} with params ${stringify2(t,null,2)}
 
        ${r}: ${n}: ${stringify2(i)}`)}if(r instanceof eP)throw r;if(r)throw Error(r.message)}async fetchEndpoint(e,t){try{let a=await this.fetch(e,t,this.requestId+=1),{error:r,result:n}=await a.json();return this.errorHandler(e,t,r),n}catch(a){throw this.errorHandler(e,t,a?.response?.data,a),a}}async getChainId(){return this.chainId??=await this.fetchEndpoint("starknet_chainId"),this.chainId}async getSpecVersion(){return this.specVersion??=await this.fetchEndpoint("starknet_specVersion"),this.specVersion}getNonceForAddress(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getNonce",{contract_address:a,block_id:r})}getBlockLatestAccepted(){return this.fetchEndpoint("starknet_blockHashAndNumber")}getBlockNumber(){return this.fetchEndpoint("starknet_blockNumber")}getBlockWithTxHashes(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxHashes",{block_id:t})}getBlockWithTxs(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockWithTxs",{block_id:t})}getBlockWithReceipts(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockWithReceipts",{block_id:t})}getBlockStateUpdate(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getStateUpdate",{block_id:t})}getBlockTransactionsTraces(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_traceBlockTransactions",{block_id:t})}getBlockTransactionCount(e=this.blockIdentifier){let t=new tL(e).identifier;return this.fetchEndpoint("starknet_getBlockTransactionCount",{block_id:t})}getTransactionByHash(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionByHash",{transaction_hash:t})}getTransactionByBlockIdAndIndex(e,t){let a=new tL(e).identifier;return this.fetchEndpoint("starknet_getTransactionByBlockIdAndIndex",{block_id:a,index:t})}getTransactionReceipt(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionReceipt",{transaction_hash:t})}getTransactionTrace(e){let t=toHex(e);return this.fetchEndpoint("starknet_traceTransaction",{transaction_hash:t})}getTransactionStatus(e){let t=toHex(e);return this.fetchEndpoint("starknet_getTransactionStatus",{transaction_hash:t})}simulateTransaction(e,t={}){let{blockIdentifier:a=this.blockIdentifier,skipValidate:r=!0,skipFeeCharge:n=!0}=t,i=new tL(a).identifier,s=[];return r&&s.push(ec.ESimulationFlag.SKIP_VALIDATE),n&&s.push(ec.ESimulationFlag.SKIP_FEE_CHARGE),this.fetchEndpoint("starknet_simulateTransactions",{block_id:i,transactions:e.map(e=>this.buildTransaction(e)),simulation_flags:s})}async waitForTransaction(e,t){let a;let r=toHex(e),{retries:n}=this,i=!1,s=!1,o=t?.retryInterval??this.transactionRetryIntervalDefault,c=t?.errorStates??[ec.ETransactionStatus.REJECTED],l=t?.successStates??[ec.ETransactionExecutionStatus.SUCCEEDED,ec.ETransactionStatus.ACCEPTED_ON_L2,ec.ETransactionStatus.ACCEPTED_ON_L1];for(;!i;){await wait(o);try{a=await this.getTransactionStatus(r);let e=a.execution_status,t=a.finality_status;if(!t){let e=Error("waiting for transaction status");throw e}if(c.includes(e)||c.includes(t)){let r=`${e}: ${t}`,n=Error(r);throw n.response=a,s=!0,n}(l.includes(e)||l.includes(t))&&(i=!0)}catch(e){if(e instanceof Error&&s)throw e;if(n<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}n-=1}let d=null;for(;null===d;){try{d=await this.getTransactionReceipt(r)}catch(e){if(n<=0)throw Error(`waitForTransaction timed-out with retries ${this.retries}`)}n-=1,await wait(o)}return d}getStorageAt(e,t,a=this.blockIdentifier){let r=toHex(e),n=toStorageKey(t),i=new tL(a).identifier;return this.fetchEndpoint("starknet_getStorageAt",{contract_address:r,key:n,block_id:i})}getClassHashAt(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClassHashAt",{block_id:r,contract_address:a})}getClass(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClass",{class_hash:a,block_id:r})}getClassAt(e,t=this.blockIdentifier){let a=toHex(e),r=new tL(t).identifier;return this.fetchEndpoint("starknet_getClassAt",{block_id:r,contract_address:a})}async getEstimateFee(e,{blockIdentifier:t=this.blockIdentifier,skipValidate:a=!0}){let r=new tL(t).identifier,n={};return isVersion("0.5",await this.getSpecVersion())||(n={simulation_flags:a?[ec.ESimulationFlag.SKIP_VALIDATE]:[]}),this.fetchEndpoint("starknet_estimateFee",{request:e.map(e=>this.buildTransaction(e,"fee")),block_id:r,...n})}async invoke(e,t){let a;return a=isV3Tx(t)?this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{type:ec.ETransactionType.INVOKE,sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),version:ec.ETransactionVersion.V3,signature:signatureToHexArray(e.signature),nonce:toHex(t.nonce),resource_bounds:t.resourceBounds,tip:toHex(t.tip),paymaster_data:t.paymasterData.map(e=>toHex(e)),account_deployment_data:t.accountDeploymentData.map(e=>toHex(e)),nonce_data_availability_mode:t.nonceDataAvailabilityMode,fee_data_availability_mode:t.feeDataAvailabilityMode}}):this.fetchEndpoint("starknet_addInvokeTransaction",{invoke_transaction:{sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),type:ec.ETransactionType.INVOKE,max_fee:toHex(t.maxFee||0),version:ec.ETransactionVersion.V1,signature:signatureToHexArray(e.signature),nonce:toHex(t.nonce)}}),this.waitMode?this.waitForTransaction((await a).transaction_hash):a}async declare({contract:e,signature:t,senderAddress:a,compiledClassHash:r},n){let i;if(isSierra(e)||isV3Tx(n)){if(isSierra(e)&&!isV3Tx(n))i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:ec.ETransactionType.DECLARE,contract_class:{sierra_program:decompressProgram(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},compiled_class_hash:r||"",version:ec.ETransactionVersion.V2,max_fee:toHex(n.maxFee||0),signature:signatureToHexArray(t),sender_address:a,nonce:toHex(n.nonce)}});else if(isSierra(e)&&isV3Tx(n))i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:ec.ETransactionType.DECLARE,sender_address:a,compiled_class_hash:r||"",version:ec.ETransactionVersion.V3,signature:signatureToHexArray(t),nonce:toHex(n.nonce),contract_class:{sierra_program:decompressProgram(e.sierra_program),contract_class_version:e.contract_class_version,entry_points_by_type:e.entry_points_by_type,abi:e.abi},resource_bounds:n.resourceBounds,tip:toHex(n.tip),paymaster_data:n.paymasterData.map(e=>toHex(e)),account_deployment_data:n.accountDeploymentData.map(e=>toHex(e)),nonce_data_availability_mode:n.nonceDataAvailabilityMode,fee_data_availability_mode:n.feeDataAvailabilityMode}});else throw Error("declare unspotted parameters")}else i=this.fetchEndpoint("starknet_addDeclareTransaction",{declare_transaction:{type:ec.ETransactionType.DECLARE,contract_class:{program:e.program,entry_points_by_type:e.entry_points_by_type,abi:e.abi},version:ec.ETransactionVersion.V1,max_fee:toHex(n.maxFee||0),signature:signatureToHexArray(t),sender_address:a,nonce:toHex(n.nonce)}});return this.waitMode?this.waitForTransaction((await i).transaction_hash):i}async deployAccount({classHash:e,constructorCalldata:t,addressSalt:a,signature:r},n){let i;return i=isV3Tx(n)?this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{type:ec.ETransactionType.DEPLOY_ACCOUNT,version:ec.ETransactionVersion.V3,signature:signatureToHexArray(r),nonce:toHex(n.nonce),contract_address_salt:toHex(a||0),constructor_calldata:tp.toHex(t||[]),class_hash:toHex(e),resource_bounds:n.resourceBounds,tip:toHex(n.tip),paymaster_data:n.paymasterData.map(e=>toHex(e)),nonce_data_availability_mode:n.nonceDataAvailabilityMode,fee_data_availability_mode:n.feeDataAvailabilityMode}}):this.fetchEndpoint("starknet_addDeployAccountTransaction",{deploy_account_transaction:{constructor_calldata:tp.toHex(t||[]),class_hash:toHex(e),contract_address_salt:toHex(a||0),type:ec.ETransactionType.DEPLOY_ACCOUNT,max_fee:toHex(n.maxFee||0),version:ec.ETransactionVersion.V1,signature:signatureToHexArray(r),nonce:toHex(n.nonce)}}),this.waitMode?this.waitForTransaction((await i).transaction_hash):i}callContract(e,t=this.blockIdentifier){let a=new tL(t).identifier;return this.fetchEndpoint("starknet_call",{request:{contract_address:e.contractAddress,entry_point_selector:getSelectorFromName(e.entrypoint),calldata:tp.toHex(e.calldata)},block_id:a})}estimateMessageFee(e,t=this.blockIdentifier){let{from_address:a,to_address:r,entry_point_selector:n,payload:i}=e,s={from_address:validateAndParseEthAddress(a),to_address:toHex(r),entry_point_selector:getSelector(n),payload:getHexStringArray(i)},o=new tL(t).identifier;return this.fetchEndpoint("starknet_estimateMessageFee",{message:s,block_id:o})}getSyncingStats(){return this.fetchEndpoint("starknet_syncing")}getEvents(e){return this.fetchEndpoint("starknet_getEvents",{filter:e})}buildTransaction(e,t){let a;let r=getVersionsByType(t);if(a=isV3Tx(e)?{signature:signatureToHexArray(e.signature),nonce:toHex(e.nonce),resource_bounds:e.resourceBounds,tip:toHex(e.tip),paymaster_data:e.paymasterData.map(e=>toHex(e)),nonce_data_availability_mode:e.nonceDataAvailabilityMode,fee_data_availability_mode:e.feeDataAvailabilityMode,account_deployment_data:e.accountDeploymentData.map(e=>toHex(e))}:{signature:signatureToHexArray(e.signature),nonce:toHex(e.nonce),max_fee:toHex(e.maxFee||0)},"INVOKE_FUNCTION"===e.type)return{type:ec.ETransactionType.INVOKE,sender_address:e.contractAddress,calldata:tp.toHex(e.calldata),version:toHex(e.version||r.v3),...a};if("DECLARE"===e.type)return isSierra(e.contract)?{type:e.type,contract_class:{...e.contract,sierra_program:decompressProgram(e.contract.sierra_program)},compiled_class_hash:e.compiledClassHash||"",sender_address:e.senderAddress,version:toHex(e.version||r.v3),...a}:{type:e.type,contract_class:e.contract,sender_address:e.senderAddress,version:toHex(e.version||r.v1),...a};if("DEPLOY_ACCOUNT"===e.type){let{account_deployment_data:t,...n}=a;return{type:e.type,constructor_calldata:tp.toHex(e.constructorCalldata||[]),class_hash:toHex(e.classHash),contract_address_salt:toHex(e.addressSalt||0),version:toHex(e.version||r.v3),...n}}throw Error("RPC buildTransaction received unknown TransactionType")}},tY=class{margin;constructor(e){this.margin=e}estimatedFeeToMaxFee(e){return estimatedFeeToMaxFee(e,this.margin?.maxFee)}estimateFeeToBounds(e){return estimateFeeToBounds(e,this.margin?.l1BoundMaxAmount,this.margin?.l1BoundMaxPricePerUnit)}parseGetBlockResponse(e){return{status:"PENDING",...e}}parseTransactionReceipt(e){return"actual_fee"in e&&isString(e.actual_fee)?{...e,actual_fee:{amount:e.actual_fee,unit:"FRI"}}:e}parseFeeEstimateResponse(e){let t=e[0];return{overall_fee:toBigInt(t.overall_fee),gas_consumed:toBigInt(t.gas_consumed),gas_price:toBigInt(t.gas_price),unit:t.unit,suggestedMaxFee:this.estimatedFeeToMaxFee(t.overall_fee),resourceBounds:this.estimateFeeToBounds(t),data_gas_consumed:t.data_gas_consumed?toBigInt(t.data_gas_consumed):0n,data_gas_price:t.data_gas_price?toBigInt(t.data_gas_price):0n}}parseFeeEstimateBulkResponse(e){return e.map(e=>({overall_fee:toBigInt(e.overall_fee),gas_consumed:toBigInt(e.gas_consumed),gas_price:toBigInt(e.gas_price),unit:e.unit,suggestedMaxFee:this.estimatedFeeToMaxFee(e.overall_fee),resourceBounds:this.estimateFeeToBounds(e),data_gas_consumed:e.data_gas_consumed?toBigInt(e.data_gas_consumed):0n,data_gas_price:e.data_gas_price?toBigInt(e.data_gas_price):0n}))}parseSimulateTransactionResponse(e){return e.map(e=>({...e,suggestedMaxFee:this.estimatedFeeToMaxFee(e.fee_estimation.overall_fee),resourceBounds:this.estimateFeeToBounds(e.fee_estimation)}))}parseContractClassResponse(e){return{...e,abi:isString(e.abi)?JSON.parse(e.abi):e.abi}}parseL1GasPriceResponse(e){return e.l1_gas_price.price_in_wei}},tG=class _ReceiptTx{statusReceipt;value;constructor(e){for(let[t]of([this.statusReceipt,this.value]=_ReceiptTx.isSuccess(e)?["success",e]:_ReceiptTx.isReverted(e)?["reverted",e]:_ReceiptTx.isRejected(e)?["rejected",e]:["error",Error("Unknown response type")],Object.entries(this)))Object.defineProperty(this,t,{enumerable:!1});for(let[t,a]of Object.entries(e))Object.defineProperty(this,t,{enumerable:!0,writable:!1,value:a})}match(e){return this.statusReceipt in e?e[this.statusReceipt](this.value):e._()}isSuccess(){return"success"===this.statusReceipt}isReverted(){return"reverted"===this.statusReceipt}isRejected(){return"rejected"===this.statusReceipt}isError(){return"error"===this.statusReceipt}static isSuccess(e){return"SUCCEEDED"===e.execution_status}static isReverted(e){return"REVERTED"===e.execution_status}static isRejected(e){return"REJECTED"===e.status}},tX=class{responseParser;channel;constructor(e){e&&"channel"in e?(this.channel=e.channel,this.responseParser="responseParser"in e?e.responseParser:new tY):(this.channel=new tW({...e,waitMode:!1}),this.responseParser=new tY(e?.feeMarginPercentage))}fetch(e,t,a=0){return this.channel.fetch(e,t,a)}async getChainId(){return this.channel.getChainId()}async getSpecVersion(){return this.channel.getSpecVersion()}async getNonceForAddress(e,t){return this.channel.getNonceForAddress(e,t)}async getBlock(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseGetBlockResponse)}async getBlockLatestAccepted(){return this.channel.getBlockLatestAccepted()}async getBlockNumber(){return this.channel.getBlockNumber()}async getBlockWithTxHashes(e){return this.channel.getBlockWithTxHashes(e)}async getBlockWithTxs(e){return this.channel.getBlockWithTxs(e)}async waitForBlock(e="pending",t=5e3){if("latest"===e)return;let a=await this.getBlockNumber(),r="pending"===e?a+1:Number(toHex(e));if(r<=a)return;let{retries:n}=this.channel,i=n,s=!1;for(;!s;){let e=await this.getBlockNumber();if(e===r?s=!0:await wait(t),(i-=1)<=0)throw Error(`waitForBlock() timed-out after ${n} tries.`)}}async getL1GasPrice(e){return this.channel.getBlockWithTxHashes(e).then(this.responseParser.parseL1GasPriceResponse)}async getL1MessageHash(e){let t=await this.channel.getTransactionByHash(e);assert("L1_HANDLER"===t.type,"This L2 transaction is not a L1 message.");let{calldata:a,contract_address:r,entry_point_selector:n,nonce:i}=t,s=[a[0],r,i,n,a.length-1,...a.slice(1)],o=addHexPrefix(s.reduce((e,t)=>e+removeHexPrefix(toHex(t)).padStart(64,"0"),""));return addHexPrefix((0,ew.bytesToHex)((0,eD.keccak_256)(hexToBytes(o))))}async getBlockWithReceipts(e){if(this.channel instanceof eV.RpcChannel)throw new eP("Unsupported method for RPC version");return this.channel.getBlockWithReceipts(e)}getStateUpdate=this.getBlockStateUpdate;async getBlockStateUpdate(e){return this.channel.getBlockStateUpdate(e)}async getBlockTransactionsTraces(e){return this.channel.getBlockTransactionsTraces(e)}async getBlockTransactionCount(e){return this.channel.getBlockTransactionCount(e)}async getPendingTransactions(){let{transactions:e}=await this.getBlockWithTxHashes("pending").then(this.responseParser.parseGetBlockResponse);return Promise.all(e.map(e=>this.getTransactionByHash(e)))}async getTransaction(e){return this.channel.getTransactionByHash(e)}async getTransactionByHash(e){return this.channel.getTransactionByHash(e)}async getTransactionByBlockIdAndIndex(e,t){return this.channel.getTransactionByBlockIdAndIndex(e,t)}async getTransactionReceipt(e){let t=await this.channel.getTransactionReceipt(e),a=this.responseParser.parseTransactionReceipt(t);return new tG(a)}async getTransactionTrace(e){return this.channel.getTransactionTrace(e)}async getTransactionStatus(e){return this.channel.getTransactionStatus(e)}async getSimulateTransaction(e,t){return this.channel.simulateTransaction(e,t).then(e=>this.responseParser.parseSimulateTransactionResponse(e))}async waitForTransaction(e,t){let a=await this.channel.waitForTransaction(e,t);return new tG(a)}async getStorageAt(e,t,a){return this.channel.getStorageAt(e,t,a)}async getClassHashAt(e,t){return this.channel.getClassHashAt(e,t)}async getClassByHash(e){return this.getClass(e)}async getClass(e,t){return this.channel.getClass(e,t).then(this.responseParser.parseContractClassResponse)}async getClassAt(e,t){return this.channel.getClassAt(e,t).then(this.responseParser.parseContractClassResponse)}async getContractVersion(e,t,{blockIdentifier:a=this.channel.blockIdentifier,compiler:r=!0}={}){let n;if(e)n=await this.getClassAt(e,a);else if(t)n=await this.getClass(t,a);else throw Error("getContractVersion require contractAddress or classHash");if(isSierra(n)){if(r){let e=getAbiContractVersion(n.abi);return{cairo:"1",compiler:e.compiler}}return{cairo:"1",compiler:void 0}}return{cairo:"0",compiler:"0"}}async getEstimateFee(e,t,a,r){return this.getInvokeEstimateFee(e,t,a,r)}async getInvokeEstimateFee(e,t,a,r){return this.channel.getEstimateFee([{type:"INVOKE_FUNCTION",...e,...t}],{blockIdentifier:a,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getDeclareEstimateFee(e,t,a,r){return this.channel.getEstimateFee([{type:"DECLARE",...e,...t}],{blockIdentifier:a,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getDeployAccountEstimateFee(e,t,a,r){return this.channel.getEstimateFee([{type:"DEPLOY_ACCOUNT",...e,...t}],{blockIdentifier:a,skipValidate:r}).then(e=>this.responseParser.parseFeeEstimateResponse(e))}async getEstimateFeeBulk(e,t){return this.channel.getEstimateFee(e,t).then(e=>this.responseParser.parseFeeEstimateBulkResponse(e))}async invokeFunction(e,t){return this.channel.invoke(e,t)}async declareContract(e,t){return this.channel.declare(e,t)}async deployAccountContract(e,t){return this.channel.deployAccount(e,t)}async callContract(e,t){return this.channel.callContract(e,t)}async estimateMessageFee(e,t){return this.channel.estimateMessageFee(e,t)}async getSyncingStats(){return this.channel.getSyncingStats()}async getEvents(e){return this.channel.getEvents(e)}},tz=a(51423),tZ={};__export(tZ,{StarknetIdContract:()=>t6,StarknetIdIdentityContract:()=>t3,StarknetIdMulticallContract:()=>t4,StarknetIdPfpContract:()=>t9,StarknetIdPopContract:()=>t7,StarknetIdVerifierContract:()=>t8,dynamicCallData:()=>dynamicCallData,dynamicFelt:()=>dynamicFelt,execution:()=>execution,getStarknetIdContract:()=>getStarknetIdContract,getStarknetIdIdentityContract:()=>getStarknetIdIdentityContract,getStarknetIdMulticallContract:()=>getStarknetIdMulticallContract,getStarknetIdPfpContract:()=>getStarknetIdPfpContract,getStarknetIdPopContract:()=>getStarknetIdPopContract,getStarknetIdVerifierContract:()=>getStarknetIdVerifierContract,useDecoded:()=>useDecoded,useEncoded:()=>useEncoded});var tJ="abcdefghijklmnopqrstuvwxyz0123456789-",tQ=BigInt(tJ.length+1),t0="这来",t1=BigInt(tJ.length),t2=BigInt(t0.length),t5=BigInt(t0.length+1);function extractStars(e){let t=0;for(;e.endsWith(t0[t0.length-1]);)e=e.substring(0,e.length-1),t+=1;return[e,t]}function useDecoded(e){let t="";return(e.forEach(e=>{for(;e!==ep;){let a=e%tQ;if(e/=tQ,a===BigInt(tJ.length)){let a=e/t5;if(a===ep){let r=e%t5;e=a,r===ep?t+=tJ[0]:t+=t0[Number(r)-1]}else{let a=e%t2;t+=t0[Number(a)],e/=t2}}else t+=tJ[Number(a)]}let[a,r]=extractStars(t);r&&(t=a+(r%2==0?t0[t0.length-1].repeat(r/2-1)+t0[0]+tJ[1]:t0[t0.length-1].repeat((r-1)/2+1))),t+="."}),t)?t.concat("stark"):t}function useEncoded(e){let t=BigInt(0),a=BigInt(1);if(e.endsWith(t0[0]+tJ[1])){let[t,a]=extractStars(e.substring(0,e.length-2));e=t+t0[t0.length-1].repeat(2*(a+1))}else{let[t,a]=extractStars(e);a&&(e=t+t0[t0.length-1].repeat(1+2*(a-1)))}for(let r=0;r<e.length;r+=1){let n=e[r],i=tJ.indexOf(n),s=BigInt(tJ.indexOf(n));if(-1!==i)r===e.length-1&&e[r]===tJ[0]?(t+=a*t1,a*=tQ*tQ):(t+=a*s,a*=tQ);else if(-1!==t0.indexOf(n)){t+=a*t1,a*=tQ;let i=(r===e.length-1?1:0)+t0.indexOf(n);t+=a*BigInt(i),a*=t2}}return t}var t6=((B=t6||{}).MAINNET="0x6ac597f8116f886fa1c97a23fa4e08299975ecaf6b598873ca6792b9bbfb678",B.TESTNET_SEPOLIA="0x154bc2e1af9260b9e66af0e9c46fc757ff893b3ff6a85718a810baf1474",B);function getStarknetIdContract(e){switch(e){case"0x534e5f4d41494e":return"0x6ac597f8116f886fa1c97a23fa4e08299975ecaf6b598873ca6792b9bbfb678";case"0x534e5f5345504f4c4941":return"0x154bc2e1af9260b9e66af0e9c46fc757ff893b3ff6a85718a810baf1474";default:throw Error("Starknet.id is not yet deployed on this network")}}var t3=((P=t3||{}).MAINNET="0x05dbdedc203e92749e2e746e2d40a768d966bd243df04a6b712e222bc040a9af",P.TESTNET_SEPOLIA="0x3697660a0981d734780731949ecb2b4a38d6a58fc41629ed611e8defda",P);function getStarknetIdIdentityContract(e){switch(e){case"0x534e5f4d41494e":return"0x05dbdedc203e92749e2e746e2d40a768d966bd243df04a6b712e222bc040a9af";case"0x534e5f5345504f4c4941":return"0x3697660a0981d734780731949ecb2b4a38d6a58fc41629ed611e8defda";default:throw Error("Starknet.id verifier contract is not yet deployed on this network")}}var t4="0x034ffb8f4452df7a613a0210824d6414dbadcddce6c6e19bf4ddc9e22ce5f970";function getStarknetIdMulticallContract(e){switch(e){case"0x534e5f4d41494e":case"0x534e5f5345504f4c4941":return t4;default:throw Error("Starknet.id multicall contract is not yet deployed on this network")}}var t8=((N=t8||{}).MAINNET="0x07d14dfd8ee95b41fce179170d88ba1f0d5a512e13aeb232f19cfeec0a88f8bf",N.TESTNET_SEPOLIA="0x60B94fEDe525f815AE5E8377A463e121C787cCCf3a36358Aa9B18c12c4D566",N);function getStarknetIdVerifierContract(e){switch(e){case"0x534e5f4d41494e":return"0x07d14dfd8ee95b41fce179170d88ba1f0d5a512e13aeb232f19cfeec0a88f8bf";case"0x534e5f5345504f4c4941":return"0x60B94fEDe525f815AE5E8377A463e121C787cCCf3a36358Aa9B18c12c4D566";default:throw Error("Starknet.id verifier contract is not yet deployed on this network")}}var t9=((O=t9||{}).MAINNET="0x070aaa20ec4a46da57c932d9fd89ca5e6bb9ca3188d3df361a32306aff7d59c7",O.TESTNET_SEPOLIA="0x9e7bdb8dabd02ea8cfc23b1d1c5278e46490f193f87516ed5ff2dfec02",O);function getStarknetIdPfpContract(e){switch(e){case"0x534e5f4d41494e":return"0x070aaa20ec4a46da57c932d9fd89ca5e6bb9ca3188d3df361a32306aff7d59c7";case"0x534e5f5345504f4c4941":return"0x9e7bdb8dabd02ea8cfc23b1d1c5278e46490f193f87516ed5ff2dfec02";default:throw Error("Starknet.id profile picture verifier contract is not yet deployed on this network")}}var t7=((F=t7||{}).MAINNET="0x0293eb2ba9862f762bd3036586d5755a782bd22e6f5028320f1d0405fd47bff4",F.TESTNET_SEPOLIA="0x15ae88ae054caa74090b89025c1595683f12edf7a4ed2ad0274de3e1d4a",F);function getStarknetIdPopContract(e){switch(e){case"0x534e5f4d41494e":return"0x0293eb2ba9862f762bd3036586d5755a782bd22e6f5028320f1d0405fd47bff4";case"0x534e5f5345504f4c4941":return"0x15ae88ae054caa74090b89025c1595683f12edf7a4ed2ad0274de3e1d4a";default:throw Error("Starknet.id proof of personhood verifier contract is not yet deployed on this network")}}function execution(e,t,a){return new ti({Static:e,IfEqual:t?tuple(t[0],t[1],t[2]):void 0,IfNotEqual:a?tuple(a[0],a[1],a[2]):void 0})}function dynamicFelt(e,t){return new ti({Hardcoded:e,Reference:t?tuple(t[0],t[1]):void 0})}function dynamicCallData(e,t,a){return new ti({Hardcoded:e,Reference:t?tuple(t[0],t[1]):void 0,ArrayReference:a?tuple(a[0],a[1]):void 0})}var ae=class _StarknetId{async getStarkName(e,t){return _StarknetId.getStarkName(this,e,t)}async getAddressFromStarkName(e,t){return _StarknetId.getAddressFromStarkName(this,e,t)}async getStarkProfile(e,t,a,r,n,i,s){return _StarknetId.getStarkProfile(this,e,t,a,r,n,i,s)}static async getStarkName(e,t,a){let r=await e.getChainId(),n=a??getStarknetIdContract(r);try{let a=await e.callContract({contractAddress:n,entrypoint:"address_to_domain",calldata:tp.compile({address:t,hint:[]})}),r=a.map(e=>BigInt(e)).slice(1),i=useDecoded(r);if(!i)throw Error("Starkname not found");return i}catch(e){if(e instanceof Error&&"Starkname not found"===e.message)throw e;throw Error("Could not get stark name")}}static async getAddressFromStarkName(e,t,a){let r=await e.getChainId(),n=a??getStarknetIdContract(r);try{let a=t.replace(".stark","").split(".").map(e=>useEncoded(e).toString(10)),r=await e.callContract({contractAddress:n,entrypoint:"domain_to_address",calldata:tp.compile({domain:a,hint:[]})});return r[0]}catch{throw Error("Could not get address from stark name")}}static async getStarkProfile(e,t,a,r,n,i,s,o){let c=await e.getChainId(),l=a??getStarknetIdContract(c),d=r??getStarknetIdIdentityContract(c),u=n??getStarknetIdVerifierContract(c),h=i??getStarknetIdPfpContract(c),p=s??getStarknetIdPopContract(c),g=o??getStarknetIdMulticallContract(c);try{let a=[{execution:execution({}),to:dynamicCallData(l),selector:dynamicCallData(getSelectorFromName("address_to_domain")),calldata:[dynamicCallData(t),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(l),selector:dynamicFelt(getSelectorFromName("domain_to_id")),calldata:[dynamicCallData(void 0,void 0,[0,0])]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("twitter")),dynamicCallData(u),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("github")),dynamicCallData(u),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("discord")),dynamicCallData(u),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("proof_of_personhood")),dynamicCallData(p),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("nft_pp_contract")),dynamicCallData(h),dynamicCallData("0")]},{execution:execution({}),to:dynamicFelt(d),selector:dynamicFelt(getSelectorFromName("get_extended_verifier_data")),calldata:[dynamicCallData(void 0,[1,0]),dynamicCallData(encodeShortString("nft_pp_id")),dynamicCallData("2"),dynamicCallData(h),dynamicCallData("0")]},{execution:execution(void 0,void 0,[6,0,0]),to:dynamicFelt(void 0,[6,0]),selector:dynamicFelt(getSelectorFromName("tokenURI")),calldata:[dynamicCallData(void 0,[7,1]),dynamicCallData(void 0,[7,2])]}],r=await e.callContract({contractAddress:g,entrypoint:"aggregate",calldata:tp.compile({calls:a})});if(Array.isArray(r)){let e=parseInt(r[0],16),t=[],a=1;for(let n=0;n<e;n+=1)if(a<r.length){let e=parseInt(r[a],16);a+=1;let n=r.slice(a,a+e);t.push(n),a+=e}else break;let n=useDecoded(t[0].slice(1).map(e=>BigInt(e))),i="0x0"!==t[2][0]?BigInt(t[2][0]).toString():void 0,s="0x0"!==t[3][0]?BigInt(t[3][0]).toString():void 0,o="0x0"!==t[4][0]?BigInt(t[4][0]).toString():void 0,c="0x1"===t[5][0],l="0x9"===r[0]?t[8].slice(1).map(e=>decodeShortString(e)).join(""):void 0,d=l||`https://starknet.id/api/identicons/${BigInt(t[1][0]).toString()}`;return{name:n,twitter:i,github:s,discord:o,proofOfPersonhood:c,profilePicture:d}}throw Error("Error while calling aggregate function")}catch(e){if(e instanceof Error)throw e;throw Error("Could not get user stark profile data from address")}}},at=class extends(0,tz.Mixin)(tX,ae){},aa=class{},ar=new tX({default:!0}),an=class{},ai={};__export(ai,{TypedDataRevision:()=>eG.TypedDataRevision,encodeData:()=>encodeData,encodeType:()=>encodeType,encodeValue:()=>encodeValue,getDependencies:()=>getDependencies,getMessageHash:()=>getMessageHash,getStructHash:()=>getStructHash,getTypeHash:()=>getTypeHash,isMerkleTreeType:()=>isMerkleTreeType,prepareSelector:()=>prepareSelector});var as={};__export(as,{MerkleTree:()=>ao,proofMerklePath:()=>function proofMerklePath(e,t,a,r=computePedersenHash){if(0===a.length)return e===t;let[n,...i]=a;return proofMerklePath(e,ao.hash(t,n,r),i,r)}});var ao=class _MerkleTree{leaves;branches=[];root;hashMethod;constructor(e,t=computePedersenHash){this.hashMethod=t,this.leaves=e,this.root=this.build(e)}build(e){if(1===e.length)return e[0];e.length!==this.leaves.length&&this.branches.push(e);let t=[];for(let a=0;a<e.length;a+=2)a+1===e.length?t.push(_MerkleTree.hash(e[a],"0x0",this.hashMethod)):t.push(_MerkleTree.hash(e[a],e[a+1],this.hashMethod));return this.build(t)}static hash(e,t,a=computePedersenHash){let[r,n]=[BigInt(e),BigInt(t)].sort((e,t)=>e>=t?1:-1);return a(r,n)}getProof(e,t=this.leaves,a=[]){let r=t.indexOf(e);if(-1===r)throw Error("leaf not found");if(1===t.length)return a;let n=r%2==0,i=(n?t[r+1]:t[r-1])??"0x0",s=[...a,i],o=this.leaves.length===t.length?-1:this.branches.findIndex(e=>e.length===t.length),c=this.branches[o+1]??[this.root];return this.getProof(_MerkleTree.hash(n?e:i,n?i:e,this.hashMethod),c,s)}},ac={u256:JSON.parse('[{ "name": "low", "type": "u128" }, { "name": "high", "type": "u128" }]'),TokenAmount:JSON.parse('[{ "name": "token_address", "type": "ContractAddress" }, { "name": "amount", "type": "u256" }]'),NftId:JSON.parse('[{ "name": "collection_address", "type": "ContractAddress" }, { "name": "token_id", "type": "u256" }]')},al={[eG.TypedDataRevision.ACTIVE]:{domain:"StarknetDomain",hashMethod:computePoseidonHashOnElements,hashMerkleMethod:computePoseidonHash,escapeTypeString:e=>`"${e}"`,presetTypes:ac},[eG.TypedDataRevision.LEGACY]:{domain:"StarkNetDomain",hashMethod:tH,hashMerkleMethod:computePedersenHash,escapeTypeString:e=>e,presetTypes:{}}};function assertRange(e,t,{min:a,max:r}){let n=BigInt(e);assert(n>=a&&n<=r,`${n} (${t}) is out of bounds [${a}, ${r}]`)}function identifyRevision({types:e,domain:t}){return al[eG.TypedDataRevision.ACTIVE].domain in e&&t.revision===eG.TypedDataRevision.ACTIVE?eG.TypedDataRevision.ACTIVE:al[eG.TypedDataRevision.LEGACY].domain in e&&(t.revision??eG.TypedDataRevision.LEGACY)===eG.TypedDataRevision.LEGACY?eG.TypedDataRevision.LEGACY:void 0}function getHex(e){try{return toHex(e)}catch(t){if(isString(e))return toHex(encodeShortString(e));throw Error(`Invalid BigNumberish: ${e}`)}}function prepareSelector(e){return isHex(e)?e:getSelectorFromName(e)}function isMerkleTreeType(e){return"merkletree"===e.type}function getDependencies(e,t,a=[],r="",n=eG.TypedDataRevision.LEGACY){return("*"===t[t.length-1]?t=t.slice(0,-1):n===eG.TypedDataRevision.ACTIVE&&("enum"===t?t=r:t.match(/^\(.*\)$/)&&(t=t.slice(1,-1))),a.includes(t)||!e[t])?a:[t,...e[t].reduce((t,a)=>[...t,...getDependencies(e,a.type,t,a.contains,n).filter(e=>!t.includes(e))],[])]}function encodeType(e,t,a=eG.TypedDataRevision.LEGACY){let r=a===eG.TypedDataRevision.ACTIVE?{...e,...al[a].presetTypes}:e,[n,...i]=getDependencies(r,t,void 0,void 0,a),s=n?[n,...i.sort()]:[],o=al[a].escapeTypeString;return s.map(e=>{let t=r[e].map(e=>{let t="enum"===e.type&&a===eG.TypedDataRevision.ACTIVE?e.contains:e.type,r=t.match(/^\(.*\)$/)?`(${t.slice(1,-1).split(",").map(e=>e?o(e):e).join(",")})`:o(t);return`${o(e.name)}:${r}`});return`${o(e)}(${t})`}).join("")}function getTypeHash(e,t,a=eG.TypedDataRevision.LEGACY){return getSelectorFromName(encodeType(e,t,a))}function encodeValue(e,t,a,r={},n=eG.TypedDataRevision.LEGACY){if(e[t])return[t,getStructHash(e,t,a,n)];if(al[n].presetTypes[t])return[t,getStructHash(al[n].presetTypes,t,a,n)];if(t.endsWith("*")){let r=a.map(a=>encodeValue(e,t.slice(0,-1),a,void 0,n)[1]);return[t,al[n].hashMethod(r)]}switch(t){case"enum":if(n===eG.TypedDataRevision.ACTIVE){let[i,s]=Object.entries(a)[0],o=e[r.parent][0],c=e[o.contains],l=c.find(e=>e.name===i),d=c.indexOf(l),u=l.type.slice(1,-1).split(",").map((t,a)=>{if(!t)return t;let r=s[a];return encodeValue(e,t,r,void 0,n)[1]});return[t,al[n].hashMethod([d,...u])]}return[t,getHex(a)];case"merkletree":{let t=function(e,t){if(t.parent&&t.key){let a=e[t.parent],r=a.find(e=>e.name===t.key),n=isMerkleTreeType(r);if(!n)throw Error(`${t.key} is not a merkle tree`);if(r.contains.endsWith("*"))throw Error(`Merkle tree contain property must not be an array but was given ${t.key}`);return r.contains}return"raw"}(e,r),i=a.map(a=>encodeValue(e,t,a,void 0,n)[1]),{root:s}=new ao(i,al[n].hashMerkleMethod);return["felt",s]}case"selector":return["felt",prepareSelector(a)];case"string":if(n===eG.TypedDataRevision.ACTIVE){let e=byteArrayFromString(a),r=[e.data.length,...e.data,e.pending_word,e.pending_word_len];return[t,al[n].hashMethod(r)]}return[t,getHex(a)];case"i128":if(n===eG.TypedDataRevision.ACTIVE){let e=BigInt(a);return assertRange(e,t,eE),[t,getHex(e<0n?ef+e:e)]}return[t,getHex(a)];case"timestamp":case"u128":return n===eG.TypedDataRevision.ACTIVE&&assertRange(a,t,eb),[t,getHex(a)];case"felt":case"shortstring":return n===eG.TypedDataRevision.ACTIVE&&assertRange(getHex(a),t,e_),[t,getHex(a)];case"ClassHash":case"ContractAddress":return n===eG.TypedDataRevision.ACTIVE&&assertRange(a,t,e_),[t,getHex(a)];case"bool":return n===eG.TypedDataRevision.ACTIVE&&assert("boolean"==typeof a,`Type mismatch for ${t} ${a}`),[t,getHex(a)];default:if(n===eG.TypedDataRevision.ACTIVE)throw Error(`Unsupported type: ${t}`);return[t,getHex(a)]}}function encodeData(e,t,a,r=eG.TypedDataRevision.LEGACY){let n=e[t]??al[r].presetTypes[t],[i,s]=n.reduce(([n,i],s)=>{if(void 0===a[s.name]||null===a[s.name]&&"enum"!==s.type)throw Error(`Cannot encode data: missing data for '${s.name}'`);let o=a[s.name],c={parent:t,key:s.name},[l,d]=encodeValue(e,s.type,o,c,r);return[[...n,l],[...i,d]]},[["felt"],[getTypeHash(e,t,r)]]);return[i,s]}function getStructHash(e,t,a,r=eG.TypedDataRevision.LEGACY){return al[r].hashMethod(encodeData(e,t,a,r)[1])}function getMessageHash(e,t){if(!(e.message&&e.primaryType&&e.types&&identifyRevision(e)))throw Error("Typed data does not match JSON schema");let a=identifyRevision(e),{domain:r,hashMethod:n}=al[a],i=[encodeShortString("StarkNet Message"),getStructHash(e.types,r,e.domain,a),t,getStructHash(e.types,e.primaryType,e.message,a)];return n(i)}var ad=class{pk;constructor(e=tT.utils.randomPrivateKey()){this.pk=e instanceof Uint8Array?buf2hex(e):toHex(e)}async getPubKey(){return tT.getStarkKey(this.pk)}async signMessage(e,t){let a=getMessageHash(e,t);return this.signRaw(a)}async signTransaction(e,t){let a;let r=getExecuteCalldata(e,t.cairoVersion);if(Object.values(W.ETransactionVersion2).includes(t.version))a=calculateInvokeTransactionHash2({...t,senderAddress:t.walletAddress,compiledCalldata:r,version:t.version});else if(Object.values(W.ETransactionVersion3).includes(t.version))a=calculateInvokeTransactionHash2({...t,senderAddress:t.walletAddress,compiledCalldata:r,version:t.version,nonceDataAvailabilityMode:intDAM(t.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(t.feeDataAvailabilityMode)});else throw Error("unsupported signTransaction version");return this.signRaw(a)}async signDeployAccountTransaction(e){let t;let a=tp.compile(e.constructorCalldata);if(Object.values(W.ETransactionVersion2).includes(e.version))t=calculateDeployAccountTransactionHash3({...e,salt:e.addressSalt,constructorCalldata:a,version:e.version});else if(Object.values(W.ETransactionVersion3).includes(e.version))t=calculateDeployAccountTransactionHash3({...e,salt:e.addressSalt,compiledConstructorCalldata:a,version:e.version,nonceDataAvailabilityMode:intDAM(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(e.feeDataAvailabilityMode)});else throw Error("unsupported signDeployAccountTransaction version");return this.signRaw(t)}async signDeclareTransaction(e){let t;if(Object.values(W.ETransactionVersion2).includes(e.version))t=calculateDeclareTransactionHash3({...e,version:e.version});else if(Object.values(W.ETransactionVersion3).includes(e.version))t=calculateDeclareTransactionHash3({...e,version:e.version,nonceDataAvailabilityMode:intDAM(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(e.feeDataAvailabilityMode)});else throw Error("unsupported signDeclareTransaction version");return this.signRaw(t)}async signRaw(e){return tT.sign(e,this.pk)}},au=a(88193),ah={};function uint256ToBN(e){return new te(e).toBigInt()}function isUint256(e){return te.is(e)}function bnToUint256(e){return new te(e).toUint256HexString()}__export(ah,{UINT_128_MAX:()=>e5,UINT_256_MAX:()=>e6,bnToUint256:()=>bnToUint256,isUint256:()=>isUint256,uint256ToBN:()=>uint256ToBN});var ap=class{pk;constructor(e=ethRandomPrivateKey()){this.pk=e instanceof Uint8Array?buf2hex(e).padStart(64,"0"):removeHexPrefix(toHex(e)).padStart(64,"0")}async getPubKey(){return addHexPrefix(buf2hex(au.secp256k1.getPublicKey(this.pk,!1)).padStart(130,"0").slice(2))}async signMessage(e,t){let a=getMessageHash(e,t),r=au.secp256k1.sign(removeHexPrefix(sanitizeHex(a)),this.pk);return this.formatEthSignature(r)}async signTransaction(e,t){let a;let r=getExecuteCalldata(e,t.cairoVersion);if(Object.values(W.ETransactionVersion2).includes(t.version))a=calculateInvokeTransactionHash2({...t,senderAddress:t.walletAddress,compiledCalldata:r,version:t.version});else if(Object.values(W.ETransactionVersion3).includes(t.version))a=calculateInvokeTransactionHash2({...t,senderAddress:t.walletAddress,compiledCalldata:r,version:t.version,nonceDataAvailabilityMode:intDAM(t.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(t.feeDataAvailabilityMode)});else throw Error("unsupported signTransaction version");let n=au.secp256k1.sign(removeHexPrefix(sanitizeHex(a)),this.pk);return this.formatEthSignature(n)}async signDeployAccountTransaction(e){let t;let a=tp.compile(e.constructorCalldata);if(Object.values(W.ETransactionVersion2).includes(e.version))t=calculateDeployAccountTransactionHash3({...e,salt:e.addressSalt,constructorCalldata:a,version:e.version});else if(Object.values(W.ETransactionVersion3).includes(e.version))t=calculateDeployAccountTransactionHash3({...e,salt:e.addressSalt,compiledConstructorCalldata:a,version:e.version,nonceDataAvailabilityMode:intDAM(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(e.feeDataAvailabilityMode)});else throw Error("unsupported signDeployAccountTransaction version");let r=au.secp256k1.sign(removeHexPrefix(sanitizeHex(t)),this.pk);return this.formatEthSignature(r)}async signDeclareTransaction(e){let t;if(Object.values(W.ETransactionVersion2).includes(e.version))t=calculateDeclareTransactionHash3({...e,version:e.version});else if(Object.values(W.ETransactionVersion3).includes(e.version))t=calculateDeclareTransactionHash3({...e,version:e.version,nonceDataAvailabilityMode:intDAM(e.nonceDataAvailabilityMode),feeDataAvailabilityMode:intDAM(e.feeDataAvailabilityMode)});else throw Error("unsupported signDeclareTransaction version");let a=au.secp256k1.sign(removeHexPrefix(sanitizeHex(t)),this.pk);return this.formatEthSignature(a)}formatEthSignature(e){let t=bnToUint256(e.r),a=bnToUint256(e.s);return[toHex(t.low),toHex(t.high),toHex(a.low),toHex(a.high),toHex(e.recovery)]}},ag={};function isAbiEvent(e){return"event"===e.type}function getAbiEvents(e){return isCairo1Abi(e)?function(e){let t=e.filter(e=>isAbiEvent(e)&&"struct"===e.kind),a=e.filter(e=>isAbiEvent(e)&&"enum"===e.kind),r=t.reduce((e,t)=>{let r=[],{name:n}=t,i=!1,findName=e=>e.type===n;for(;;){let e=a.find(e=>e.variants.some(findName));if(void 0===e)break;let t=e.variants.find(findName);r.unshift(t.name),"flat"===t.kind&&(i=!0),n=e.name}if(0===r.length)throw Error("inconsistency in ABI events definition.");i&&(r=[r[r.length-1]]);let s=r.pop(),o={[addHexPrefix(tT.keccak(utf8ToArray(s)).toString(16))]:t};for(;r.length>0;)o={[addHexPrefix(tT.keccak(utf8ToArray(r.pop())).toString(16))]:o};return function mergeAbiEvents(e,t){let a={...e};return isObject(e)&&isObject(t)&&Object.keys(t).forEach(r=>{isObject(t[r])&&r in e?a[r]=mergeAbiEvents(e[r],t[r]):Object.assign(a,{[r]:t[r]})}),a}(e,o={...o})},{});return r}(e):e.filter(e=>"event"===e.type).reduce((e,t)=>{let a=t.name,r={...t};return r.name=a,{...e,[addHexPrefix(tT.keccak(utf8ToArray(a)).toString(16))]:r}},{})}function isObject(e){return e&&"object"==typeof e&&!Array.isArray(e)}function parseEvents(e,t,a,r){let n=e.flat().reduce((e,n)=>{let i=t[n.keys.shift()??0];if(!i)return e;for(;!i.name;){let e=n.keys.shift();assert(!!e,'Not enough data in "key" property of this event.'),i=i[e]}let s={};s[i.name]={};let o=n.keys[Symbol.iterator](),c=n.data[Symbol.iterator](),l=i.members?.filter(e=>"key"===e.kind)||i.keys,d=i.members?.filter(e=>"data"===e.kind)||i.data;return l.forEach(e=>{s[i.name][e.name]=responseParser(o,e,a,r,s[i.name])}),d.forEach(e=>{s[i.name][e.name]=responseParser(c,e,a,r,s[i.name])}),e.push(s),e},[]);return n}function parseUDCEvent(e){if(!e.events)throw Error("UDC emitted event is empty");let t=e.events.find(e=>cleanHex(e.from_address)===cleanHex(eI.ADDRESS))||{data:[]};return{transaction_hash:e.transaction_hash,contract_address:t.data[0],address:t.data[0],deployer:t.data[1],unique:t.data[2],classHash:t.data[3],calldata_len:t.data[4],calldata:t.data.slice(5,5+parseInt(t.data[4],16)),salt:t.data[t.data.length-1]}}__export(ag,{getAbiEvents:()=>getAbiEvents,isAbiEvent:()=>isAbiEvent,isObject:()=>isObject,parseEvents:()=>parseEvents,parseUDCEvent:()=>parseUDCEvent});var ay=class extends at{signer;address;cairoVersion;transactionVersion;constructor(e,t,a,r,n=W.ETransactionVersion.V2){super(e),this.address=t.toLowerCase(),this.signer=isString(a)||a instanceof Uint8Array?new ad(a):a,r&&(this.cairoVersion=r.toString()),this.transactionVersion=n}getPreferredVersion(e,t){return this.transactionVersion===W.ETransactionVersion.V3?t:this.transactionVersion===W.ETransactionVersion.V2?e:W.ETransactionVersion.V3}async getNonce(e){return super.getNonceForAddress(this.address,e)}async getNonceSafe(e){try{return toBigInt(e??await this.getNonce())}catch(e){return 0n}}async getCairoVersion(e){if(!this.cairoVersion){let{cairo:t}=e?await super.getContractVersion(void 0,e):await super.getContractVersion(this.address);this.cairoVersion=t}return this.cairoVersion}async estimateFee(e,t={}){return this.estimateInvokeFee(e,t)}async estimateInvokeFee(e,t={}){let{nonce:a,blockIdentifier:r,version:n,skipValidate:i=!0}=t,s=Array.isArray(e)?e:[e],o=toBigInt(a??await this.getNonce()),c=toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.F1,W.ETransactionVersion.F3),toFeeVersion(n)),l=await this.getChainId(),d={...v3Details(t),walletAddress:this.address,nonce:o,maxFee:ep,version:c,chainId:l,cairoVersion:await this.getCairoVersion(),skipValidate:i},u=await this.buildInvocation(s,d);return super.getInvokeEstimateFee({...u},{...v3Details(t),version:c,nonce:o},r,t.skipValidate)}async estimateDeclareFee(e,t={}){let{blockIdentifier:a,nonce:r,version:n,skipValidate:i=!0}=t,s=toBigInt(r??await this.getNonce()),o=toTransactionVersion(isSierra(e.contract)?this.getPreferredVersion(W.ETransactionVersion.F2,W.ETransactionVersion.F3):W.ETransactionVersion.F1,toFeeVersion(n)),c=await this.getChainId(),l=await this.buildDeclarePayload(e,{...v3Details(t),nonce:s,chainId:c,version:o,walletAddress:this.address,maxFee:ep,cairoVersion:void 0,skipValidate:i});return super.getDeclareEstimateFee(l,{...v3Details(t),version:o,nonce:s},a,t.skipValidate)}async estimateAccountDeployFee({classHash:e,addressSalt:t=0,constructorCalldata:a=[],contractAddress:r},n={}){let{blockIdentifier:i,version:s,skipValidate:o=!0}=n,c=toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.F1,W.ETransactionVersion.F3),toFeeVersion(s)),l=await this.getChainId(),d=await this.buildAccountDeployPayload({classHash:e,addressSalt:t,constructorCalldata:a,contractAddress:r},{...v3Details(n),nonce:ep,chainId:l,version:c,walletAddress:this.address,maxFee:ep,cairoVersion:void 0,skipValidate:o});return super.getDeployAccountEstimateFee({...d},{...v3Details(n),version:c,nonce:ep},i,n.skipValidate)}async estimateDeployFee(e,t={}){let a=this.buildUDCContractPayload(e);return this.estimateInvokeFee(a,t)}async estimateFeeBulk(e,t={}){let{nonce:a,blockIdentifier:r,version:n,skipValidate:i}=t,s=await this.accountInvocationsFactory(e,{...v3Details(t),versions:[W.ETransactionVersion.F1,toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.F2,W.ETransactionVersion.F3),n)],nonce:a,blockIdentifier:r,skipValidate:i});return super.getEstimateFeeBulk(s,{blockIdentifier:r,skipValidate:i})}async simulateTransaction(e,t={}){let{nonce:a,blockIdentifier:r,skipValidate:n=!0,skipExecute:i,version:s}=t,o=await this.accountInvocationsFactory(e,{...v3Details(t),versions:[W.ETransactionVersion.V1,toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.V2,W.ETransactionVersion.V3),s)],nonce:a,blockIdentifier:r,skipValidate:n});return super.getSimulateTransaction(o,{blockIdentifier:r,skipValidate:n,skipExecute:i})}async execute(e,t,a={}){let r=void 0===t||Array.isArray(t)?a:t,n=Array.isArray(e)?e:[e],i=toBigInt(r.nonce??await this.getNonce()),s=toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.V1,W.ETransactionVersion.V3),r.version),o=await this.getUniversalSuggestedFee(s,{type:"INVOKE_FUNCTION",payload:e},{...r,version:s}),c=await this.getChainId(),l={...v3Details(r),resourceBounds:o.resourceBounds,walletAddress:this.address,nonce:i,maxFee:o.maxFee,version:s,chainId:c,cairoVersion:await this.getCairoVersion()},d=await this.signer.signTransaction(n,l),u=getExecuteCalldata(n,await this.getCairoVersion());return this.invokeFunction({contractAddress:this.address,calldata:u,signature:d},{...v3Details(r),resourceBounds:o.resourceBounds,nonce:i,maxFee:o.maxFee,version:s})}async declareIfNot(e,t={}){let a=extractContractHashes(e);try{await this.getClassByHash(a.classHash)}catch(a){return this.declare(e,t)}return{transaction_hash:"",class_hash:a.classHash}}async declare(e,t={}){let a=extractContractHashes(e),{nonce:r,version:n}=t,i=toTransactionVersion(isSierra(e.contract)?this.getPreferredVersion(W.ETransactionVersion.V2,W.ETransactionVersion.V3):W.ETransactionVersion.V1,n),s=await this.getUniversalSuggestedFee(i,{type:"DECLARE",payload:a},{...t,version:i}),o={...v3Details(t),resourceBounds:s.resourceBounds,maxFee:s.maxFee,nonce:toBigInt(r??await this.getNonce()),version:i,chainId:await this.getChainId(),walletAddress:this.address,cairoVersion:void 0},c=await this.buildDeclarePayload(a,o);return this.declareContract(c,o)}async deploy(e,t={}){let{calls:a,addresses:r}=buildUDCCall(e,this.address),n=await this.execute(a,void 0,t);return{...n,contract_address:r}}async deployContract(e,t={}){let a=await this.deploy(e,t),r=await this.waitForTransaction(a.transaction_hash);return parseUDCEvent(r)}async declareAndDeploy(e,t={}){let{constructorCalldata:a,salt:r,unique:n}=e,i=await this.declareIfNot(e,t);if(""!==i.transaction_hash){let e=await this.waitForTransaction(i.transaction_hash);i={...i,...e}}let s=await this.deployContract({classHash:i.class_hash,salt:r,unique:n,constructorCalldata:a},t);return{declare:{...i},deploy:s}}deploySelf=this.deployAccount;async deployAccount({classHash:e,constructorCalldata:t=[],addressSalt:a=0,contractAddress:r},n={}){let i=toTransactionVersion(this.getPreferredVersion(W.ETransactionVersion.V1,W.ETransactionVersion.V3),n.version),s=await this.getChainId(),o=tp.compile(t),c=r??calculateContractAddressFromHash(a,e,o,0),l=await this.getUniversalSuggestedFee(i,{type:"DEPLOY_ACCOUNT",payload:{classHash:e,constructorCalldata:o,addressSalt:a,contractAddress:c}},n),d=await this.signer.signDeployAccountTransaction({...v3Details(n),classHash:e,constructorCalldata:o,contractAddress:c,addressSalt:a,chainId:s,resourceBounds:l.resourceBounds,maxFee:l.maxFee,version:i,nonce:ep});return this.deployAccountContract({classHash:e,addressSalt:a,constructorCalldata:t,signature:d},{...v3Details(n),nonce:ep,resourceBounds:l.resourceBounds,maxFee:l.maxFee,version:i})}async signMessage(e){return this.signer.signMessage(e,this.address)}async hashMessage(e){return getMessageHash(e,this.address)}async verifyMessageHash(e,t,a,r){let n;let i=r||{okResponse:[],nokResponse:["0x0","0x00"],error:["argent/invalid-signature","is invalid, with respect to the public key","INVALID_SIG"]};for(let r of a?[a]:["isValidSignature","is_valid_signature"])try{let a=await this.callContract({contractAddress:this.address,entrypoint:r,calldata:tp.compile({hash:toBigInt(e).toString(),signature:formatSignature(t)})});if(i.nokResponse.includes(a[0].toString()))return!1;if(0===i.okResponse.length||i.okResponse.includes(a[0].toString()))return!0;throw Error("signatureVerificationResponse Error: response is not part of known responses")}catch(e){if(i.error.some(t=>e.message.includes(t)))return!1;n=e}throw Error(`Signature verification Error: ${n}`)}async verifyMessage(e,t,a,r){let n=await this.hashMessage(e);return this.verifyMessageHash(n,t,a,r)}async getUniversalSuggestedFee(e,{type:t,payload:a},r){let n=0,i=estimateFeeToBounds(ep);return e===W.ETransactionVersion.V3?i=r.resourceBounds??(await this.getSuggestedFee({type:t,payload:a},r)).resourceBounds:n=r.maxFee??(await this.getSuggestedFee({type:t,payload:a},r)).suggestedMaxFee,{maxFee:n,resourceBounds:i}}async getSuggestedFee({type:e,payload:t},a){let r;switch(e){case"INVOKE_FUNCTION":r=await this.estimateInvokeFee(t,a);break;case"DECLARE":r=await this.estimateDeclareFee(t,a);break;case"DEPLOY_ACCOUNT":r=await this.estimateAccountDeployFee(t,a);break;case"DEPLOY":r=await this.estimateDeployFee(t,a);break;default:r={gas_consumed:0n,gas_price:0n,overall_fee:ep,unit:"FRI",suggestedMaxFee:ep,resourceBounds:estimateFeeToBounds(ep),data_gas_consumed:0n,data_gas_price:0n}}return r}async buildInvocation(e,t){let a=getExecuteCalldata(e,await this.getCairoVersion()),r=t.skipValidate?[]:await this.signer.signTransaction(e,t);return{...v3Details(t),contractAddress:this.address,calldata:a,signature:r}}async buildDeclarePayload(e,t){let{classHash:a,contract:r,compiledClassHash:n}=extractContractHashes(e),i=parseContract(r);if(void 0===n&&(t.version===W.ETransactionVersion3.F3||t.version===W.ETransactionVersion3.V3))throw Error("V3 Transaction work with Cairo1 Contracts and require compiledClassHash");let s=t.skipValidate?[]:await this.signer.signDeclareTransaction({...t,...v3Details(t),classHash:a,compiledClassHash:n,senderAddress:t.walletAddress});return{senderAddress:t.walletAddress,signature:s,contract:i,compiledClassHash:n}}async buildAccountDeployPayload({classHash:e,addressSalt:t=0,constructorCalldata:a=[],contractAddress:r},n){let i=tp.compile(a),s=r??calculateContractAddressFromHash(t,e,i,0),o=n.skipValidate?[]:await this.signer.signDeployAccountTransaction({...n,...v3Details(n),classHash:e,contractAddress:s,addressSalt:t,constructorCalldata:i});return{...v3Details(n),classHash:e,addressSalt:t,constructorCalldata:i,signature:o}}buildUDCContractPayload(e){let t=[].concat(e).map(e=>{let{classHash:t,salt:a="0",unique:r=!0,constructorCalldata:n=[]}=e,i=tp.compile(n);return{contractAddress:eI.ADDRESS,entrypoint:eI.ENTRYPOINT,calldata:[t,a,toCairoBool(r),i.length,...i]}});return t}async accountInvocationsFactory(e,t){let{nonce:a,blockIdentifier:r,skipValidate:n=!0}=t,i=await this.getNonceSafe(a),s=await this.getChainId(),o=t.versions.map(e=>toTransactionVersion(e)),c="payload"in e[0]?e[0].payload:e[0],l="DEPLOY_ACCOUNT"===e[0].type?await this.getCairoVersion(c.classHash):await this.getCairoVersion();return Promise.all([].concat(e).map(async(e,a)=>{let c="payload"in e?e.payload:e,d={...v3Details(t),walletAddress:this.address,nonce:toBigInt(Number(i)+a),maxFee:ep,chainId:s,cairoVersion:l,version:"",skipValidate:n},u={type:e.type,nonce:toBigInt(Number(i)+a),blockIdentifier:r,version:""};if("INVOKE_FUNCTION"===e.type){let e=reduceV2(o[1]);d.version=e,u.version=e;let t=await this.buildInvocation([].concat(c),d);return{...u,...t}}if("DEPLOY"===e.type){let e=reduceV2(o[1]);d.version=e,u.version=e;let t=this.buildUDCContractPayload(c),a=await this.buildInvocation(t,d);return{...u,...a,type:"INVOKE_FUNCTION"}}if("DECLARE"===e.type){let e=isSierra(c.contract)?o[1]:o[0];d.version=e,u.version=e;let t=await this.buildDeclarePayload(c,d);return{...u,...t}}if("DEPLOY_ACCOUNT"===e.type){let e=reduceV2(o[1]);d.version=e,u.version=e;let t=await this.buildAccountDeployPayload(c,d);return{...u,...t}}throw Error(`accountInvocationsFactory: unsupported transaction type: ${e}`)}))}async getStarkName(e=this.address,t){return super.getStarkName(e,t)}},af=class extends aa{},am={};function requestAccounts(e,t=!1){return e.request({type:"wallet_requestAccounts",params:{silent_mode:t}})}function getPermissions(e){return e.request({type:"wallet_getPermissions"})}function watchAsset(e,t){return e.request({type:"wallet_watchAsset",params:t})}function addStarknetChain(e,t){return e.request({type:"wallet_addStarknetChain",params:t})}function switchStarknetChain(e,t){return e.request({type:"wallet_switchStarknetChain",params:{chainId:t}})}function requestChainId(e){return e.request({type:"wallet_requestChainId"})}function deploymentData(e){return e.request({type:"wallet_deploymentData"})}function addInvokeTransaction(e,t){return e.request({type:"wallet_addInvokeTransaction",params:t})}function addDeclareTransaction(e,t){return e.request({type:"wallet_addDeclareTransaction",params:t})}function signMessage(e,t){return e.request({type:"wallet_signTypedData",params:t})}function supportedSpecs(e){return e.request({type:"wallet_supportedSpecs"})}function onAccountChange(e,t){e.on("accountsChanged",t)}function onNetworkChanged(e,t){e.on("networkChanged",t)}__export(am,{addDeclareTransaction:()=>addDeclareTransaction,addInvokeTransaction:()=>addInvokeTransaction,addStarknetChain:()=>addStarknetChain,deploymentData:()=>deploymentData,getPermissions:()=>getPermissions,onAccountChange:()=>onAccountChange,onNetworkChanged:()=>onNetworkChanged,requestAccounts:()=>requestAccounts,requestChainId:()=>requestChainId,signMessage:()=>signMessage,supportedSpecs:()=>supportedSpecs,switchStarknetChain:()=>switchStarknetChain,watchAsset:()=>watchAsset});var aT=class extends ay{address="";walletProvider;constructor(e,t,a){super(e,"","",a),this.walletProvider=t,this.walletProvider.on("accountsChanged",e=>{e&&(this.address=e[0].toLowerCase())}),this.walletProvider.on("networkChanged",e=>{e&&this.channel.setChainId(e)}),t.request({type:"wallet_requestAccounts",params:{silent_mode:!1}}).then(e=>{this.address=e[0].toLowerCase()})}onAccountChange(e){onAccountChange(this.walletProvider,e)}onNetworkChanged(e){onNetworkChanged(this.walletProvider,e)}requestAccounts(e=!1){return requestAccounts(this.walletProvider,e)}getPermissions(){return getPermissions(this.walletProvider)}switchStarknetChain(e){return switchStarknetChain(this.walletProvider,e)}watchAsset(e){return watchAsset(this.walletProvider,e)}addStarknetChain(e){return addStarknetChain(this.walletProvider,e)}execute(e){let t=[].concat(e).map(e=>{let{contractAddress:t,entrypoint:a,calldata:r}=e;return{contract_address:t,entry_point:a,calldata:r}});return addInvokeTransaction(this.walletProvider,{calls:t})}declare(e){let t=extractContractHashes(e),a=e.contract,r={...a,abi:stringify2(a.abi)};if(!t.compiledClassHash)throw Error("compiledClassHash is required");let n={compiled_class_hash:t.compiledClassHash,contract_class:r};return addDeclareTransaction(this.walletProvider,n)}async deploy(e){let{calls:t,addresses:a}=buildUDCCall(e,this.address),r=await this.execute(t);return{...r,contract_address:a}}signMessage(e){return signMessage(this.walletProvider,e)}},splitArgsAndOptions=e=>{let t=e[e.length-1];return"object"==typeof t&&["blockIdentifier","parseRequest","parseResponse","formatResponse","maxFee","nonce","signature","addressSalt"].some(e=>e in t)?{args:e,options:e.pop()}:{args:e}};function buildCall(e,t){return async function(...a){let r=splitArgsAndOptions(a);return e.call(t.name,r.args,{parseRequest:!0,parseResponse:!0,...r.options})}}function buildDefault(e,t){return"view"===t.stateMutability||"view"===t.state_mutability?buildCall(e,t):async function(...a){let r=splitArgsAndOptions(a);return e.invoke(t.name,r.args,{parseRequest:!0,...r.options})}}function getCalldata(e,t){return Array.isArray(e)&&"__compiled__"in e?e:Array.isArray(e)&&Array.isArray(e[0])&&"__compiled__"in e[0]?e[0]:t()}var a_=class{abi;address;providerOrAccount;deployTransactionHash;structs;events;functions;callStatic;populateTransaction;estimateFee;callData;constructor(e,t,a=ar){this.address=t&&t.toLowerCase(),this.providerOrAccount=a,this.callData=new tp(e),this.structs=tp.getAbiStruct(e),this.events=getAbiEvents(e);let r=createAbiParser(e);this.abi=r.getLegacyFormat();let n={enumerable:!0,value:{},writable:!1};Object.defineProperties(this,{functions:{enumerable:!0,value:{},writable:!1},callStatic:{enumerable:!0,value:{},writable:!1},populateTransaction:{enumerable:!0,value:{},writable:!1},estimateFee:{enumerable:!0,value:{},writable:!1}}),this.abi.forEach(e=>{var t,a;if("function"!==e.type)return;let r=e.name;this[r]||Object.defineProperty(this,r,{...n,value:buildDefault(this,e)}),this.functions[r]||Object.defineProperty(this.functions,r,{...n,value:buildDefault(this,e)}),this.callStatic[r]||Object.defineProperty(this.callStatic,r,{...n,value:buildCall(this,e)}),this.populateTransaction[r]||Object.defineProperty(this.populateTransaction,r,{...n,value:(t=this,function(...a){return t.populate(e.name,a)})}),this.estimateFee[r]||Object.defineProperty(this.estimateFee,r,{...n,value:(a=this,function(...t){return a.estimate(e.name,t)})})})}attach(e){this.address=e}connect(e){this.providerOrAccount=e}async deployed(){return this.deployTransactionHash&&(await this.providerOrAccount.waitForTransaction(this.deployTransactionHash),this.deployTransactionHash=void 0),this}async call(e,t=[],{parseRequest:a=!0,parseResponse:r=!0,formatResponse:n,blockIdentifier:i}={}){assert(null!==this.address,"contract is not connected to an address");let s=getCalldata(t,()=>a?(this.callData.validate("CALL",e,t),this.callData.compile(e,t)):(console.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),t));return this.providerOrAccount.callContract({contractAddress:this.address,calldata:s,entrypoint:e},i).then(t=>r?n?this.callData.format(e,t,n):this.callData.parse(e,t):t)}invoke(e,t=[],{parseRequest:a=!0,maxFee:r,nonce:n,signature:i}={}){assert(null!==this.address,"contract is not connected to an address");let s=getCalldata(t,()=>a?(this.callData.validate("INVOKE",e,t),this.callData.compile(e,t)):(console.warn("Invoke skipped parsing but provided rawArgs, possible malfunction request"),t)),o={contractAddress:this.address,calldata:s,entrypoint:e};if("execute"in this.providerOrAccount)return this.providerOrAccount.execute(o,void 0,{maxFee:r,nonce:n});if(!n)throw Error("Nonce is required when invoking a function without an account");return console.warn(`Invoking ${e} without an account. This will not work on a public node.`),this.providerOrAccount.invokeFunction({...o,signature:i},{nonce:n})}async estimate(e,t=[]){assert(null!==this.address,"contract is not connected to an address"),getCalldata(t,()=>!1)||this.callData.validate("INVOKE",e,t);let a=this.populate(e,t);if("estimateInvokeFee"in this.providerOrAccount)return this.providerOrAccount.estimateInvokeFee(a);throw Error("Contract must be connected to the account contract to estimate")}populate(e,t=[]){let a=getCalldata(t,()=>this.callData.compile(e,t));return{contractAddress:this.address,entrypoint:e,calldata:a}}parseEvents(e){return parseEvents(e.events?.filter(e=>cleanHex(e.from_address)===cleanHex(this.address),[])||[],this.events,this.structs,tp.getAbiEnum(this.abi))}isCairo1(){return e2.isCairo1Abi(this.abi)}async getVersion(){return this.providerOrAccount.getContractVersion(this.address)}typedv2(e){return this}},aE=class{functions;callStatic;populateTransaction;estimateFee},ab=class{compiledContract;account;abi;classHash;casm;compiledClassHash;CallData;constructor(e){this.compiledContract=e.compiledContract,this.account=e.account,this.casm=e.casm,this.abi=e.abi??e.compiledContract.abi,this.classHash=e.classHash,this.compiledClassHash=e.compiledClassHash,this.CallData=new tp(this.abi)}async deploy(...e){let{args:t,options:a={parseRequest:!0}}=splitArgsAndOptions(e),r=getCalldata(t,()=>a.parseRequest?(this.CallData.validate("DEPLOY","constructor",t),this.CallData.compile("constructor",t)):(console.warn("Call skipped parsing but provided rawArgs, possible malfunction request"),t)),{deploy:{contract_address:n,transaction_hash:i}}=await this.account.declareAndDeploy({contract:this.compiledContract,casm:this.casm,classHash:this.classHash,compiledClassHash:this.compiledClassHash,constructorCalldata:r,salt:a.addressSalt});assert(!!n,"Deployment of the contract failed");let s=new a_(this.compiledContract.abi,n,this.account);return s.deployTransactionHash=i,s}connect(e){return this.account=e,this}attach(e){return new a_(this.abi,e,this.account)}},av=class{},aA=a(9653);function addAddressPadding(e){let t=toHex(addHexPrefix(e.toString())),a=removeHexPrefix(t).padStart(64,"0");return addHexPrefix(a)}function validateAndParseAddress(e){let t=addAddressPadding(e);if(!t.match(/^(0x)?[0-9a-fA-F]{64}$/))throw Error("Invalid Address Format");return assertInRange(t,ep,eT-1n,"Starknet Address"),t}function getChecksumAddress(e){let t=removeHexPrefix(validateAndParseAddress(e)).toLowerCase().split(""),a=removeHexPrefix(keccakBn(e)),r=(0,aA.hexToBytes)(a.padStart(64,"0"));for(let e=0;e<t.length;e+=2)r[e>>1]>>4>=8&&(t[e]=t[e].toUpperCase()),(15&r[e>>1])>=8&&(t[e+1]=t[e+1].toUpperCase());return addHexPrefix(t.join(""))}function validateChecksumAddress(e){return getChecksumAddress(e)===e}var aC=__toESM(a(17872)),ax=/^(?:\w+:)?\/\/(\S+)$/,aS=/^localhost[:?\d]*(?:[^:?\d]\S*)?$/,aI=/^[^\s.]+\.\S{2,}$/;function isUrl(e){if(!e||"string"!=typeof e)return!1;let t=e.match(ax);if(!t)return!1;let a=t[1];return!!a&&!!(aS.test(a)||aI.test(a))}function buildUrl(e,t,a){return isUrl(a)?a:(0,aC.default)(e,a??t)}var ak=eX}}]);